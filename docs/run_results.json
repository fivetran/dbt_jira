{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.10", "generated_at": "2024-03-21T15:31:53.984196Z", "invocation_id": "ca58038f-9947-4199-a5f3-eec45b0edb02", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.461831Z", "completed_at": "2024-03-21T15:31:50.475642Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.477820Z", "completed_at": "2024-03-21T15:31:50.477838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020895957946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__comment_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"comment\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__comment_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.467737Z", "completed_at": "2024-03-21T15:31:50.476089Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.478269Z", "completed_at": "2024-03-21T15:31:50.478277Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021029233932495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__component_tmp", "compiled": true, "compiled_code": "\n\nselect * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"component\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__component_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.470279Z", "completed_at": "2024-03-21T15:31:50.477211Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.480574Z", "completed_at": "2024-03-21T15:31:50.480579Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02284097671508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__field_option_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"field_option\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field_option_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.472945Z", "completed_at": "2024-03-21T15:31:50.477486Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.480927Z", "completed_at": "2024-03-21T15:31:50.480935Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022865772247314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__field_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"field\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.486202Z", "completed_at": "2024-03-21T15:31:50.497479Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.499434Z", "completed_at": "2024-03-21T15:31:50.499441Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017258882522583008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_field_history_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"issue_field_history\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.488809Z", "completed_at": "2024-03-21T15:31:50.497787Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.499702Z", "completed_at": "2024-03-21T15:31:50.499706Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017441987991333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_link_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"issue_link\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_link_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.494379Z", "completed_at": "2024-03-21T15:31:50.498862Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.501647Z", "completed_at": "2024-03-21T15:31:50.501652Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017391204833984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"issue\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.491973Z", "completed_at": "2024-03-21T15:31:50.499184Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.501935Z", "completed_at": "2024-03-21T15:31:50.501938Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018418073654174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_multiselect_history_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"issue_multiselect_history\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.507809Z", "completed_at": "2024-03-21T15:31:50.518872Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.520862Z", "completed_at": "2024-03-21T15:31:50.520871Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01795792579650879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_type_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"issue_type\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_type_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.510347Z", "completed_at": "2024-03-21T15:31:50.519426Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.521157Z", "completed_at": "2024-03-21T15:31:50.521162Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018001794815063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__priority_tmp", "compiled": true, "compiled_code": "\n\nselect * from \"postgres\".\"jira_integrations_tests_33\".\"priority\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__priority_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.514085Z", "completed_at": "2024-03-21T15:31:50.520520Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.523341Z", "completed_at": "2024-03-21T15:31:50.523345Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01834392547607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__project_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"project\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__project_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.516626Z", "completed_at": "2024-03-21T15:31:50.521418Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.524405Z", "completed_at": "2024-03-21T15:31:50.524415Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019228219985961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__resolution_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"resolution\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__resolution_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.528518Z", "completed_at": "2024-03-21T15:31:50.541188Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.543202Z", "completed_at": "2024-03-21T15:31:50.543210Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019134998321533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__sprint_tmp", "compiled": true, "compiled_code": "\n\nselect * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"sprint\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__sprint_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.532251Z", "completed_at": "2024-03-21T15:31:50.541547Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.543496Z", "completed_at": "2024-03-21T15:31:50.543500Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019270896911621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__status_category_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"status_category\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status_category_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.536167Z", "completed_at": "2024-03-21T15:31:50.542592Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.545385Z", "completed_at": "2024-03-21T15:31:50.545390Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019030094146728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__status_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"status\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.538784Z", "completed_at": "2024-03-21T15:31:50.542877Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.545707Z", "completed_at": "2024-03-21T15:31:50.545710Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012845039367675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__user_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"user\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.554200Z", "completed_at": "2024-03-21T15:31:50.555293Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.560460Z", "completed_at": "2024-03-21T15:31:50.560468Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013275146484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.comment", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.556529Z", "completed_at": "2024-03-21T15:31:50.558328Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.562339Z", "completed_at": "2024-03-21T15:31:50.562344Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013287067413330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.component", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.558750Z", "completed_at": "2024-03-21T15:31:50.559776Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.562629Z", "completed_at": "2024-03-21T15:31:50.562633Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013400077819824219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.epic", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.551178Z", "completed_at": "2024-03-21T15:31:50.560044Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.562890Z", "completed_at": "2024-03-21T15:31:50.562893Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016656875610351562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__version_tmp", "compiled": true, "compiled_code": "\n\nselect * \nfrom \"postgres\".\"jira_integrations_tests_33\".\"version\"", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.568277Z", "completed_at": "2024-03-21T15:31:50.569468Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.574819Z", "completed_at": "2024-03-21T15:31:50.574827Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010732889175415039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.field", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.570811Z", "completed_at": "2024-03-21T15:31:50.571885Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.576388Z", "completed_at": "2024-03-21T15:31:50.576400Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010979890823364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.field_option", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.572275Z", "completed_at": "2024-03-21T15:31:50.573243Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.576843Z", "completed_at": "2024-03-21T15:31:50.576847Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011026859283447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.issue", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.573584Z", "completed_at": "2024-03-21T15:31:50.574513Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.577122Z", "completed_at": "2024-03-21T15:31:50.577126Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011264801025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.issue_field_history", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.582302Z", "completed_at": "2024-03-21T15:31:50.584364Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.590173Z", "completed_at": "2024-03-21T15:31:50.590179Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011958122253417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.issue_link", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.585890Z", "completed_at": "2024-03-21T15:31:50.586966Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.591835Z", "completed_at": "2024-03-21T15:31:50.591840Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012326955795288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.issue_multiselect_history", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.587401Z", "completed_at": "2024-03-21T15:31:50.588390Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.592128Z", "completed_at": "2024-03-21T15:31:50.592131Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012502908706665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.issue_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.588756Z", "completed_at": "2024-03-21T15:31:50.589828Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.592390Z", "completed_at": "2024-03-21T15:31:50.592393Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012594938278198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.priority", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.597439Z", "completed_at": "2024-03-21T15:31:50.598568Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.605170Z", "completed_at": "2024-03-21T15:31:50.605176Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011534929275512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.project", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.599984Z", "completed_at": "2024-03-21T15:31:50.601970Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.606643Z", "completed_at": "2024-03-21T15:31:50.606646Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011657953262329102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.project_board", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.602370Z", "completed_at": "2024-03-21T15:31:50.603359Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.606888Z", "completed_at": "2024-03-21T15:31:50.606891Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01163482666015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.project_category", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.603734Z", "completed_at": "2024-03-21T15:31:50.604778Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.607146Z", "completed_at": "2024-03-21T15:31:50.607150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011702775955200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.resolution", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.612039Z", "completed_at": "2024-03-21T15:31:50.613195Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.619472Z", "completed_at": "2024-03-21T15:31:50.619480Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011581897735595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.sprint", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.614408Z", "completed_at": "2024-03-21T15:31:50.615548Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.621007Z", "completed_at": "2024-03-21T15:31:50.621010Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011365890502929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.status", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.615963Z", "completed_at": "2024-03-21T15:31:50.616878Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.621259Z", "completed_at": "2024-03-21T15:31:50.621262Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011456012725830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.status_category", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.617184Z", "completed_at": "2024-03-21T15:31:50.619064Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.621506Z", "completed_at": "2024-03-21T15:31:50.621508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011686086654663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.user", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.626379Z", "completed_at": "2024-03-21T15:31:50.627612Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.640333Z", "completed_at": "2024-03-21T15:31:50.640340Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01764702796936035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.user_group", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.628851Z", "completed_at": "2024-03-21T15:31:50.629810Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.641751Z", "completed_at": "2024-03-21T15:31:50.641754Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01776885986328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.jira_integration_tests.version", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.645319Z", "completed_at": "2024-03-21T15:31:50.941248Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.942929Z", "completed_at": "2024-03-21T15:31:50.942933Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3254711627960205, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__field_option", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field_option_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as integer) as \n    \n    parent_id\n    \n , \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        id as field_id,\n        parent_id as parent_field_id,\n        name as field_option_name\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field_option\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.630076Z", "completed_at": "2024-03-21T15:31:50.940946Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.942315Z", "completed_at": "2024-03-21T15:31:50.942323Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.34423828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__comment", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__comment_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    author_id\n    \n as \n    \n    author_id\n    \n, \n    \n    \n    body\n    \n as \n    \n    body\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    is_public\n    \n as \n    \n    is_public\n    \n, \n    \n    \n    issue_id\n    \n as \n    \n    issue_id\n    \n, \n    \n    \n    update_author_id\n    \n as \n    \n    update_author_id\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        author_id as author_user_id,\n        body,\n        cast(created as timestamp) as created_at,\n        id as comment_id,\n        issue_id,\n        is_public,\n        update_author_id as last_update_user_id,\n        cast(updated as timestamp) as last_updated_at,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__comment\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.635499Z", "completed_at": "2024-03-21T15:31:50.941815Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.943594Z", "completed_at": "2024-03-21T15:31:50.943598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.34642982482910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__component", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__component_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    project_id\n    \n as \n    \n    project_id\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        description as component_description,\n        id as component_id,\n        name as component_name,\n        project_id,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__component\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.649760Z", "completed_at": "2024-03-21T15:31:50.989661Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:50.995266Z", "completed_at": "2024-03-21T15:31:50.995275Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3785827159881592, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__field", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    is_array\n    \n as \n    \n    is_array\n    \n, \n    \n    \n    is_custom\n    \n as \n    \n    is_custom\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        cast(id as TEXT) as field_id,\n        is_array,\n        is_custom,\n        name as field_name,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.973837Z", "completed_at": "2024-03-21T15:31:51.231730Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.232264Z", "completed_at": "2024-03-21T15:31:51.232270Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.30588388442993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_link", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_link_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    issue_id\n    \n as \n    \n    issue_id\n    \n, \n    \n    \n    related_issue_id\n    \n as \n    \n    related_issue_id\n    \n, \n    \n    \n    relationship\n    \n as \n    \n    relationship\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        issue_id,\n        related_issue_id,\n        relationship,\n        _fivetran_synced \n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_link\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.990238Z", "completed_at": "2024-03-21T15:31:51.279167Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.281098Z", "completed_at": "2024-03-21T15:31:51.281102Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.33267903327941895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue", "compiled": true, "compiled_code": "with base as (\n    \n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_tmp\"\n    where not coalesce(_fivetran_deleted, false)\n),\n\nfields as (\n\n    select \n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _original_estimate\n    \n as \n    \n    _original_estimate\n    \n, \n    \n    \n    _remaining_estimate\n    \n as \n    \n    _remaining_estimate\n    \n, \n    \n    \n    _time_spent\n    \n as \n    \n    _time_spent\n    \n, \n    \n    \n    assignee\n    \n as \n    \n    assignee\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    creator\n    \n as \n    \n    creator\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    due_date\n    \n as \n    \n    due_date\n    \n, \n    \n    \n    environment\n    \n as \n    \n    environment\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    issue_type\n    \n as \n    \n    issue_type\n    \n, \n    \n    \n    key\n    \n as \n    \n    key\n    \n, \n    \n    \n    original_estimate\n    \n as \n    \n    original_estimate\n    \n, \n    \n    \n    parent_id\n    \n as \n    \n    parent_id\n    \n, \n    \n    \n    priority\n    \n as \n    \n    priority\n    \n, \n    \n    \n    project\n    \n as \n    \n    project\n    \n, \n    \n    \n    remaining_estimate\n    \n as \n    \n    remaining_estimate\n    \n, \n    \n    \n    reporter\n    \n as \n    \n    reporter\n    \n, \n    \n    \n    resolution\n    \n as \n    \n    resolution\n    \n, \n    \n    \n    resolved\n    \n as \n    \n    resolved\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    status_category_changed\n    \n as \n    \n    status_category_changed\n    \n, \n    \n    \n    summary\n    \n as \n    \n    summary\n    \n, \n    \n    \n    time_spent\n    \n as \n    \n    time_spent\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    work_ratio\n    \n as \n    \n    work_ratio\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        coalesce(original_estimate, _original_estimate) as original_estimate_seconds,\n        coalesce(remaining_estimate, _remaining_estimate) as remaining_estimate_seconds,\n        coalesce(time_spent, _time_spent) as time_spent_seconds,\n        assignee as assignee_user_id,\n        cast(created as timestamp) as created_at,\n        cast(resolved  as timestamp) as resolved_at,\n        creator as creator_user_id,\n        description as issue_description,\n        due_date,\n        environment,\n        id as issue_id,\n        issue_type as issue_type_id,\n        key as issue_key,\n        parent_id as parent_issue_id,\n        priority as priority_id,\n        project as project_id,\n        reporter as reporter_user_id,\n        resolution as resolution_id,\n        status as status_id,\n        cast(status_category_changed as timestamp) as status_changed_at,\n        summary as issue_name,\n        cast(updated as timestamp) as updated_at,\n        work_ratio,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:50.978057Z", "completed_at": "2024-03-21T15:31:51.278520Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.280489Z", "completed_at": "2024-03-21T15:31:51.280496Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.35109901428222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_field_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    field_id\n    \n as \n    \n    field_id\n    \n, \n    \n    \n    issue_id\n    \n as \n    \n    issue_id\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n, \n    \n    \n    time\n    \n as \n    \n    time\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        cast(field_id as TEXT) as field_id,\n        issue_id,\n        cast(time as timestamp)\n         as updated_at,\n        value as field_value,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.024923Z", "completed_at": "2024-03-21T15:31:51.323482Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.330148Z", "completed_at": "2024-03-21T15:31:51.330156Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3381969928741455, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_multiselect_history", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    field_id\n    \n as \n    \n    field_id\n    \n, \n    \n    \n    issue_id\n    \n as \n    \n    issue_id\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n, \n    \n    \n    time\n    \n as \n    \n    time\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        _fivetran_id,\n        cast(field_id as TEXT) as field_id,\n        issue_id,\n        \n        cast(time as timestamp)\n         as updated_at,\n        value as field_value,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.281667Z", "completed_at": "2024-03-21T15:31:51.611442Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.613594Z", "completed_at": "2024-03-21T15:31:51.613607Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3618640899658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__issue_type", "compiled": true, "compiled_code": "with base as (\n\n    select * from \n    \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_type_tmp\"\n),\n\nfields as (\n\n    select \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    subtask\n    \n as \n    \n    subtask\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        description,\n        id as issue_type_id,\n        name as issue_type_name,\n        subtask as is_subtask,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_type\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.324934Z", "completed_at": "2024-03-21T15:31:51.638015Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.639250Z", "completed_at": "2024-03-21T15:31:51.639261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3464479446411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__priority", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__priority_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        description as priority_description,\n        id as priority_id,\n        name as priority_name,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__priority\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.330779Z", "completed_at": "2024-03-21T15:31:51.638856Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.640832Z", "completed_at": "2024-03-21T15:31:51.640840Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3455653190612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__project", "compiled": true, "compiled_code": "with base as (\n    \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__project_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    key\n    \n as \n    \n    key\n    \n, \n    \n    \n    lead_id\n    \n as \n    \n    lead_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    permission_scheme_id\n    \n as \n    \n    permission_scheme_id\n    \n, \n    \n    \n    project_category_id\n    \n as \n    \n    project_category_id\n    \n\n\n\n    from base\n\n),\n\nfinal as (\n\n    select \n        description as project_description,\n        id as project_id,\n        key as project_key,\n        lead_id as project_lead_user_id,\n        name as project_name,\n        project_category_id,\n        permission_scheme_id,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__project\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.364055Z", "completed_at": "2024-03-21T15:31:51.688902Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.689675Z", "completed_at": "2024-03-21T15:31:51.689683Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3533482551574707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__resolution", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__resolution_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        description as resolution_description,\n        id as resolution_id,\n        name as resolution_name,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__resolution\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.644042Z", "completed_at": "2024-03-21T15:31:51.919735Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.920819Z", "completed_at": "2024-03-21T15:31:51.920828Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.30823302268981934, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__sprint", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__sprint_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    board_id\n    \n as \n    \n    board_id\n    \n, \n    \n    \n    complete_date\n    \n as \n    \n    complete_date\n    \n, \n    \n    \n    end_date\n    \n as \n    \n    end_date\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    start_date\n    \n as \n    \n    start_date\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        id as sprint_id,\n        name as sprint_name,\n        board_id,\n        cast(complete_date as timestamp) as completed_at,\n        cast(end_date as timestamp) as ended_at,\n        cast(start_date as timestamp) as started_at,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__sprint\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.673096Z", "completed_at": "2024-03-21T15:31:51.940637Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.942302Z", "completed_at": "2024-03-21T15:31:51.942316Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.29885005950927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__status_category", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status_category_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        id as status_category_id,\n        name as status_category_name\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status_category\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.974226Z", "completed_at": "2024-03-21T15:31:51.982316Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.982864Z", "completed_at": "2024-03-21T15:31:51.982870Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010837078094482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__field_option_field_id.1b1f37b358", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect field_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field_option\"\nwhere field_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.984569Z", "completed_at": "2024-03-21T15:31:51.987988Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.988492Z", "completed_at": "2024-03-21T15:31:51.988498Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00499725341796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__comment_comment_id.5dec28a22a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect comment_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__comment\"\nwhere comment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.990578Z", "completed_at": "2024-03-21T15:31:51.995153Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.995709Z", "completed_at": "2024-03-21T15:31:51.995716Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006543874740600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__comment_comment_id.004104fac5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    comment_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__comment\"\nwhere comment_id is not null\ngroup by comment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.678058Z", "completed_at": "2024-03-21T15:31:51.969380Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.972067Z", "completed_at": "2024-03-21T15:31:51.972075Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.330369234085083, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__status", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status_category_id\n    \n as \n    \n    status_category_id\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        description as status_description,\n        id as status_id,\n        name as status_name,\n        status_category_id,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.718071Z", "completed_at": "2024-03-21T15:31:51.970439Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:51.973121Z", "completed_at": "2024-03-21T15:31:51.973128Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.28749704360961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__user", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    locale\n    \n as \n    \n    locale\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    username\n    \n as \n    \n    username\n    \n\n\n\n    from base\n),\n\nfinal as (\n\n    select \n        email,\n        id as user_id,\n        locale,\n        name as user_display_name,\n        time_zone,\n        username,\n        _fivetran_synced\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.997438Z", "completed_at": "2024-03-21T15:31:52.002667Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.004377Z", "completed_at": "2024-03-21T15:31:52.004384Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009077072143554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__component_component_id.2f017ad5ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect component_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__component\"\nwhere component_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.006905Z", "completed_at": "2024-03-21T15:31:52.011853Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.018758Z", "completed_at": "2024-03-21T15:31:52.018769Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015477895736694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__component_component_id.1773ebe913", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    component_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__component\"\nwhere component_id is not null\ngroup by component_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.012150Z", "completed_at": "2024-03-21T15:31:52.019839Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.021873Z", "completed_at": "2024-03-21T15:31:52.021878Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012652873992919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__field_field_id.34424f1c2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect field_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\nwhere field_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.015396Z", "completed_at": "2024-03-21T15:31:52.020615Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.022405Z", "completed_at": "2024-03-21T15:31:52.022408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016003131866455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__field_field_id.df7b462fff", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    field_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\nwhere field_id is not null\ngroup by field_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.023396Z", "completed_at": "2024-03-21T15:31:52.029058Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.037241Z", "completed_at": "2024-03-21T15:31:52.037255Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01687908172607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__issue_issue_id.13a4fbe132", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue\"\nwhere issue_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.030181Z", "completed_at": "2024-03-21T15:31:52.039428Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.047889Z", "completed_at": "2024-03-21T15:31:52.047895Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020869016647338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__issue_issue_id.7bb0ee7230", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue\"\nwhere issue_id is not null\ngroup by issue_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.040565Z", "completed_at": "2024-03-21T15:31:52.049769Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.054583Z", "completed_at": "2024-03-21T15:31:52.054594Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01678609848022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.dbt_utils_unique_combination_of_columns_stg_jira__issue_field_history_field_id__issue_id__updated_at.c01ecbb82c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        field_id, issue_id, updated_at\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\"\n    group by field_id, issue_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.056073Z", "completed_at": "2024-03-21T15:31:52.062110Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.067048Z", "completed_at": "2024-03-21T15:31:52.067056Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020706653594970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.dbt_utils_unique_combination_of_columns_stg_jira__issue_multiselect_history__fivetran_id__updated_at.4dd2d1c5a8", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        _fivetran_id, updated_at\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history\"\n    group by _fivetran_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.063558Z", "completed_at": "2024-03-21T15:31:52.072175Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.074213Z", "completed_at": "2024-03-21T15:31:52.074221Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013889074325561523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__issue_type_issue_type_id.57419fc343", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_type_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_type\"\nwhere issue_type_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.067390Z", "completed_at": "2024-03-21T15:31:52.073877Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.078750Z", "completed_at": "2024-03-21T15:31:52.078760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016983985900878906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__issue_type_issue_type_id.a89d34aa41", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_type_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_type\"\nwhere issue_type_id is not null\ngroup by issue_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.075598Z", "completed_at": "2024-03-21T15:31:52.081191Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.085991Z", "completed_at": "2024-03-21T15:31:52.085997Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01645517349243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__priority_priority_id.ec0c873363", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect priority_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__priority\"\nwhere priority_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.082559Z", "completed_at": "2024-03-21T15:31:52.090270Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.092121Z", "completed_at": "2024-03-21T15:31:52.092127Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012708187103271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__priority_priority_id.79b77ea5d2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    priority_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__priority\"\nwhere priority_id is not null\ngroup by priority_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.086364Z", "completed_at": "2024-03-21T15:31:52.091831Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.096566Z", "completed_at": "2024-03-21T15:31:52.096572Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015864133834838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__project_project_id.996fe19522", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect project_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__project\"\nwhere project_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.093458Z", "completed_at": "2024-03-21T15:31:52.098875Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.104381Z", "completed_at": "2024-03-21T15:31:52.104387Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016601085662841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__project_project_id.58d321d374", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    project_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__project\"\nwhere project_id is not null\ngroup by project_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.100018Z", "completed_at": "2024-03-21T15:31:52.108496Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.110246Z", "completed_at": "2024-03-21T15:31:52.110255Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013149023056030273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__resolution_resolution_id.1c04bac8a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect resolution_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__resolution\"\nwhere resolution_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.104709Z", "completed_at": "2024-03-21T15:31:52.109868Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.114822Z", "completed_at": "2024-03-21T15:31:52.114834Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016528844833374023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__resolution_resolution_id.b3acb37c87", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    resolution_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__resolution\"\nwhere resolution_id is not null\ngroup by resolution_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.111646Z", "completed_at": "2024-03-21T15:31:52.116970Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.121673Z", "completed_at": "2024-03-21T15:31:52.121680Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01583695411682129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__sprint_sprint_id.899b4b77d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sprint_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__sprint\"\nwhere sprint_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.118353Z", "completed_at": "2024-03-21T15:31:52.125667Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.127438Z", "completed_at": "2024-03-21T15:31:52.127444Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01224827766418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__sprint_sprint_id.8a73555fed", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sprint_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__sprint\"\nwhere sprint_id is not null\ngroup by sprint_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.122043Z", "completed_at": "2024-03-21T15:31:52.127095Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.132833Z", "completed_at": "2024-03-21T15:31:52.132845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016353130340576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__status_category_status_category_id.7a89cdfcf0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_category_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status_category\"\nwhere status_category_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.128887Z", "completed_at": "2024-03-21T15:31:52.135040Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.181418Z", "completed_at": "2024-03-21T15:31:52.181428Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05854487419128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__status_category_status_category_id.99c869330a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    status_category_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status_category\"\nwhere status_category_id is not null\ngroup by status_category_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.136412Z", "completed_at": "2024-03-21T15:31:52.185653Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.188111Z", "completed_at": "2024-03-21T15:31:52.188119Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05507707595825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__status_status_id.b32a8a0d84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status\"\nwhere status_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.181893Z", "completed_at": "2024-03-21T15:31:52.186546Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.188718Z", "completed_at": "2024-03-21T15:31:52.188726Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05930280685424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__status_status_id.0449241b95", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    status_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status\"\nwhere status_id is not null\ngroup by status_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.198109Z", "completed_at": "2024-03-21T15:31:52.208124Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.216244Z", "completed_at": "2024-03-21T15:31:52.216251Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021064043045043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__user_user_id.b2153f97d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.203330Z", "completed_at": "2024-03-21T15:31:52.215210Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.216554Z", "completed_at": "2024-03-21T15:31:52.216558Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02110910415649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__user_user_id.a397e1a23f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.232450Z", "completed_at": "2024-03-21T15:31:52.256550Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.258880Z", "completed_at": "2024-03-21T15:31:52.258888Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03912615776062012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.int_jira__agg_multiselect_history", "compiled": true, "compiled_code": "\n\n-- issue_multiselect_history splits out an array-type field into multiple rows with unique individual values\n-- to combine with issue_field_history we need to aggregate the multiselect field values.\n\nwith  __dbt__cte__int_jira__issue_multiselect_history as (\nwith issue_multiselect_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    issue_multiselect_history.*,\n    lower(fields.field_name) as field_name\n\n  from issue_multiselect_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n), issue_multiselect_history as (\n\n    select *\n    from __dbt__cte__int_jira__issue_multiselect_history\n\n    \n    -- always refresh the most recent day of data\n    where cast(updated_at as date) >= \n\n    (select max(date_day) from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__agg_multiselect_history\") + ((interval '1 day') * (-1))\n\n\n    \n\n),\n\n-- each field value has its own row, but each batch of values for that field has the same timestamp\nbatch_updates as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(field_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(issue_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(updated_at as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as batch_id\n\n    from issue_multiselect_history \n),\n\nconsolidate_batches as (\n\n    select \n        field_id,\n        field_name,\n        issue_id,\n        updated_at,\n        batch_id,\n        cast( date_trunc('day', updated_at) as date) as date_day,\n\n        -- if the field refers to an object captured in a table elsewhere (ie sprint, users, field_option for custom fields),\n        -- the value is actually a foreign key to that table. \n        \n    string_agg(batch_updates.field_value, ', ')\n\n as field_values \n\n    from batch_updates\n\n    group by 1,2,3,4,5,6\n)\n\nselect *\nfrom consolidate_batches", "relation_name": "\"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__agg_multiselect_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.228186Z", "completed_at": "2024-03-21T15:31:52.257383Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.259555Z", "completed_at": "2024-03-21T15:31:52.259561Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05111885070800781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.dbt_utils_unique_combination_of_columns_int_jira__issue_field_history_field_id__issue_id__updated_at.34d1b3eaa1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_jira__issue_field_history as (\nwith field_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    field_history.*,\n    lower(fields.field_name) as field_name\n\n  from field_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n), validation_errors as (\n\n    select\n        field_id, issue_id, updated_at\n    from __dbt__cte__int_jira__issue_field_history\n    group by field_id, issue_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.280201Z", "completed_at": "2024-03-21T15:31:52.289156Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.290653Z", "completed_at": "2024-03-21T15:31:52.290661Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01795506477355957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__issue_comments_issue_id.9f16878e45", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_jira__issue_comments as (\n\n\nwith comment as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__comment\"\n\n    order by issue_id, created_at asc\n\n),\n\n-- user is a reserved keyword in AWS \njira_user as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\n),\n\nagg_comments as (\n\n    select \n    comment.issue_id,\n    \n    string_agg(comment.created_at || '  -  ' || jira_user.user_display_name || ':  ' || comment.body, '\\n')\n\n as conversation,\n    count(comment.comment_id) as count_comments\n\n    from\n    comment \n    join jira_user on comment.author_user_id = jira_user.user_id\n\n    group by 1\n)\n\nselect * from agg_comments\n) select issue_id\nfrom __dbt__cte__int_jira__issue_comments\nwhere issue_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.275839Z", "completed_at": "2024-03-21T15:31:52.289492Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.291210Z", "completed_at": "2024-03-21T15:31:52.291214Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019291162490844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.dbt_utils_unique_combination_of_columns_int_jira__issue_multiselect_history__fivetran_id__updated_at.aad394167d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_jira__issue_multiselect_history as (\nwith issue_multiselect_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    issue_multiselect_history.*,\n    lower(fields.field_name) as field_name\n\n  from issue_multiselect_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n), validation_errors as (\n\n    select\n        _fivetran_id, updated_at\n    from __dbt__cte__int_jira__issue_multiselect_history\n    group by _fivetran_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.285298Z", "completed_at": "2024-03-21T15:31:52.290948Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.293203Z", "completed_at": "2024-03-21T15:31:52.293208Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010107278823852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__issue_comments_issue_id.26e3f11046", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_jira__issue_comments as (\n\n\nwith comment as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__comment\"\n\n    order by issue_id, created_at asc\n\n),\n\n-- user is a reserved keyword in AWS \njira_user as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\n),\n\nagg_comments as (\n\n    select \n    comment.issue_id,\n    \n    string_agg(comment.created_at || '  -  ' || jira_user.user_display_name || ':  ' || comment.body, '\\n')\n\n as conversation,\n    count(comment.comment_id) as count_comments\n\n    from\n    comment \n    join jira_user on comment.author_user_id = jira_user.user_id\n\n    group by 1\n)\n\nselect * from agg_comments\n) select\n    issue_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_jira__issue_comments\nwhere issue_id is not null\ngroup by issue_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.296572Z", "completed_at": "2024-03-21T15:31:52.311945Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.318745Z", "completed_at": "2024-03-21T15:31:52.318754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02595996856689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__issue_assign_resolution_issue_id.b3af89c733", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_jira__issue_field_history as (\nwith field_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    field_history.*,\n    lower(fields.field_name) as field_name\n\n  from field_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_assign_resolution as (\nwith issue_field_history as (\n    \n    select *\n    from __dbt__cte__int_jira__issue_field_history\n\n), \n\nfiltered as (\n    -- we're only looking at assignments and resolutions, which are single-field values\n    select *\n    from issue_field_history\n\n    where (lower(field_id) = 'assignee'\n    or lower(field_id) = 'resolutiondate')\n\n    and field_value is not null -- remove initial null rows\n),\n\nissue_dates as (\n\n    select\n\n        issue_id,\n        min(case when field_id = 'assignee' then updated_at end) as first_assigned_at,\n        max(case when field_id = 'assignee' then updated_at end) as last_assigned_at,\n        min(case when field_id = 'resolutiondate' then updated_at end) as first_resolved_at -- in case it's been re-opened\n\n    from filtered\n    group by 1\n)\n\nselect *\nfrom issue_dates\n) select issue_id\nfrom __dbt__cte__int_jira__issue_assign_resolution\nwhere issue_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.301893Z", "completed_at": "2024-03-21T15:31:52.312382Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.319132Z", "completed_at": "2024-03-21T15:31:52.319137Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025907039642333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__issue_assign_resolution_issue_id.f41f7c00ab", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_jira__issue_field_history as (\nwith field_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    field_history.*,\n    lower(fields.field_name) as field_name\n\n  from field_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_assign_resolution as (\nwith issue_field_history as (\n    \n    select *\n    from __dbt__cte__int_jira__issue_field_history\n\n), \n\nfiltered as (\n    -- we're only looking at assignments and resolutions, which are single-field values\n    select *\n    from issue_field_history\n\n    where (lower(field_id) = 'assignee'\n    or lower(field_id) = 'resolutiondate')\n\n    and field_value is not null -- remove initial null rows\n),\n\nissue_dates as (\n\n    select\n\n        issue_id,\n        min(case when field_id = 'assignee' then updated_at end) as first_assigned_at,\n        max(case when field_id = 'assignee' then updated_at end) as last_assigned_at,\n        min(case when field_id = 'resolutiondate' then updated_at end) as first_resolved_at -- in case it's been re-opened\n\n    from filtered\n    group by 1\n)\n\nselect *\nfrom issue_dates\n) select\n    issue_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_jira__issue_assign_resolution\nwhere issue_id is not null\ngroup by issue_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.306830Z", "completed_at": "2024-03-21T15:31:52.320189Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.322716Z", "completed_at": "2024-03-21T15:31:52.322724Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022643327713012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.int_jira__issue_type_parents", "compiled": true, "compiled_code": "\n-- needs to be a view to use the dbt_utils.star macro in int_jira__issue_users\n\nwith  __dbt__cte__int_jira__issue_field_history as (\nwith field_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    field_history.*,\n    lower(fields.field_name) as field_name\n\n  from field_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_epic as (\n-- issue-epic relationships are either captured via the issue's parent_issue_id (next-gen projects)\n-- or through the 'Epic Link' field (classic projects)\nwith epic_field_history as (\n\n    select *\n    from __dbt__cte__int_jira__issue_field_history\n    where lower(field_name) like 'epic%link'\n    \n),\n\norder_epic_links as (\n\n    select\n        issue_id,\n        cast(field_value as TEXT ) as epic_issue_id,\n\n        row_number() over (\n                partition by issue_id order by updated_at desc\n                ) as row_num\n\n    from epic_field_history\n),\n\nlast_epic_link as (\n\n    select \n      issue_id, \n      epic_issue_id \n    \n    from order_epic_links\n    where row_num = 1\n)\n\nselect *\nfrom last_epic_link\n), issue as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue\"\n    \n),\n\nissue_type as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_type\"\n), \n-- issue-epic relationships are either captured via the issue's parent_issue_id (next-gen projects)\n-- or through the 'Epic Link' field (classic projects)\n\nissues_w_epics as (\n\n  select * \n  from __dbt__cte__int_jira__issue_epic\n\n), \n\nissue_enriched_with_epics as (\n\n  select\n  \n    issue.*,\n    coalesce(cast(parent_issue_id as TEXT), cast(epic_issue_id as TEXT)) as revised_parent_issue_id\n  \n  from issue\n  \n  left join issues_w_epics on issues_w_epics.issue_id = issue.issue_id\n\n), \n\nissue_w_types as (\n\n    select \n\n        issue_enriched_with_epics.*,\n        issue_type.issue_type_name as issue_type\n        \n    from issue_enriched_with_epics \n    \n    left join issue_type on issue_type.issue_type_id = issue_enriched_with_epics.issue_type_id\n),\n\nadd_parent_info as (\n\n    select\n        issue_w_types.*,\n        parent.issue_type as parent_issue_type,\n        parent.issue_name as parent_issue_name,\n        parent.issue_key as parent_issue_key,\n        lower(coalesce(parent.issue_type, '')) = 'epic' as is_parent_epic\n\n    from\n    issue_w_types\n\n    -- do a left join so we can grab all issue types from this table in `issue_join`\n    left join issue_w_types as parent \n        on cast(issue_w_types.revised_parent_issue_id as TEXT) = cast(parent.issue_id as TEXT)\n\n)\n\nselect * \nfrom add_parent_info", "relation_name": "\"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_type_parents\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.329957Z", "completed_at": "2024-03-21T15:31:52.349649Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.351364Z", "completed_at": "2024-03-21T15:31:52.351372Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029582738876342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.int_jira__combine_field_histories", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_jira__issue_field_history as (\nwith field_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    field_history.*,\n    lower(fields.field_name) as field_name\n\n  from field_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n), issue_field_history as (\n\n    select * from __dbt__cte__int_jira__issue_field_history\n\n    \n    where cast( updated_at as date) >= (select max(valid_starting_on) from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__combine_field_histories\" )\n    \n),\n\nissue_multiselect_batch_history as (\n\n    select * from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__agg_multiselect_history\"\n\n    \n    where cast( updated_at as date) >= (select max(valid_starting_on) from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__combine_field_histories\" )\n    \n),\n\ncombine_field_history as (\n-- combining all the field histories together\n    select \n        field_id,\n        issue_id,\n        updated_at,\n        field_value,\n        field_name\n\n    from issue_field_history\n\n    union all\n\n    select \n        field_id,\n        issue_id,\n        updated_at,\n        field_values as field_value, -- this is an aggregated list but we'll just call it field_value\n        field_name\n\n    from issue_multiselect_batch_history\n),\n\nget_valid_dates as (\n\n\n    select \n        field_id,\n        issue_id,\n        field_value,\n        field_name,\n        updated_at as valid_starting_at,\n\n        -- this value is valid until the next value is updated\n        lead(updated_at, 1) over(partition by issue_id, field_id order by updated_at asc) as valid_ending_at, \n\n        cast( date_trunc('day', updated_at) as date) as valid_starting_on\n\n    from combine_field_history\n\n),\n\nsurrogate_key as (\n\n    select \n    *,\n    md5(cast(coalesce(cast(field_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(issue_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_starting_at as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as combined_history_id\n\n    from get_valid_dates\n\n)\n\nselect * from surrogate_key", "relation_name": "\"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__combine_field_histories\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.324644Z", "completed_at": "2024-03-21T15:31:52.350116Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.352095Z", "completed_at": "2024-03-21T15:31:52.352102Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03138422966003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.dbt_utils_unique_combination_of_columns_int_jira__issue_epic_issue_id__epic_issue_id.9ddee9201b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_jira__issue_field_history as (\nwith field_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    field_history.*,\n    lower(fields.field_name) as field_name\n\n  from field_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_epic as (\n-- issue-epic relationships are either captured via the issue's parent_issue_id (next-gen projects)\n-- or through the 'Epic Link' field (classic projects)\nwith epic_field_history as (\n\n    select *\n    from __dbt__cte__int_jira__issue_field_history\n    where lower(field_name) like 'epic%link'\n    \n),\n\norder_epic_links as (\n\n    select\n        issue_id,\n        cast(field_value as TEXT ) as epic_issue_id,\n\n        row_number() over (\n                partition by issue_id order by updated_at desc\n                ) as row_num\n\n    from epic_field_history\n),\n\nlast_epic_link as (\n\n    select \n      issue_id, \n      epic_issue_id \n    \n    from order_epic_links\n    where row_num = 1\n)\n\nselect *\nfrom last_epic_link\n), validation_errors as (\n\n    select\n        issue_id, epic_issue_id\n    from __dbt__cte__int_jira__issue_epic\n    group by issue_id, epic_issue_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.345638Z", "completed_at": "2024-03-21T15:31:52.350811Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.353129Z", "completed_at": "2024-03-21T15:31:52.353133Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009994029998779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__agg_multiselect_history_batch_id.7d6d2460a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect batch_id\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__agg_multiselect_history\"\nwhere batch_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.358104Z", "completed_at": "2024-03-21T15:31:52.383935Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.385412Z", "completed_at": "2024-03-21T15:31:52.385421Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030735015869140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__agg_multiselect_history_batch_id.14b3dea579", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    batch_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__agg_multiselect_history\"\nwhere batch_id is not null\ngroup by batch_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.361593Z", "completed_at": "2024-03-21T15:31:52.384956Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.386733Z", "completed_at": "2024-03-21T15:31:52.386738Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031221866607666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.dbt_utils_unique_combination_of_columns_int_jira__issue_sprint_issue_id__current_sprint_id.aafda24567", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_jira__issue_multiselect_history as (\nwith issue_multiselect_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    issue_multiselect_history.*,\n    lower(fields.field_name) as field_name\n\n  from issue_multiselect_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_sprint as (\n\n\nwith sprint as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__sprint\"\n\n),\n\nfield_history as (\n\n     -- sprints don't appear to be capable of multiselect in the UI...\n    select *\n    from __dbt__cte__int_jira__issue_multiselect_history\n\n),\n\nsprint_field_history as (\n\n    select \n        field_history.*,\n        sprint.*,\n        row_number() over (\n                    partition by field_history.issue_id \n                    order by field_history.updated_at desc, sprint.started_at desc         \n                    ) as row_num\n    from field_history\n    join sprint on field_history.field_value = cast(sprint.sprint_id as TEXT)\n    where lower(field_history.field_name) = 'sprint'\n),\n\n\nlast_sprint as (\n\n    select *\n    from sprint_field_history\n    \n    where row_num = 1\n\n), \n\nsprint_rollovers as (\n\n    select \n        issue_id,\n        count(distinct case when field_value is not null then field_value end) as count_sprint_changes\n    \n    from sprint_field_history\n    group by 1\n\n),\n\nissue_sprint as (\n\n    select \n        last_sprint.issue_id,\n        last_sprint.field_value as current_sprint_id,\n        last_sprint.sprint_name as current_sprint_name,\n        last_sprint.board_id,\n        last_sprint.started_at as sprint_started_at,\n        last_sprint.ended_at as sprint_ended_at,\n        last_sprint.completed_at as sprint_completed_at,\n        coalesce(sprint_rollovers.count_sprint_changes, 0) as count_sprint_changes\n\n    from \n    last_sprint \n    left join sprint_rollovers on sprint_rollovers.issue_id = last_sprint.issue_id\n    \n)\n\nselect * from issue_sprint\n), validation_errors as (\n\n    select\n        issue_id, current_sprint_id\n    from __dbt__cte__int_jira__issue_sprint\n    group by issue_id, current_sprint_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.390102Z", "completed_at": "2024-03-21T15:31:52.396144Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.396886Z", "completed_at": "2024-03-21T15:31:52.396894Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009376049041748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__issue_type_parents_issue_id.8dd98255b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_id\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_type_parents\"\nwhere issue_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.393344Z", "completed_at": "2024-03-21T15:31:52.397164Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.398876Z", "completed_at": "2024-03-21T15:31:52.398882Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01023721694946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__issue_type_parents_issue_id.c07f8c6af3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_type_parents\"\nwhere issue_id is not null\ngroup by issue_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.400639Z", "completed_at": "2024-03-21T15:31:52.407897Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.412818Z", "completed_at": "2024-03-21T15:31:52.412832Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014268159866333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.int_jira__daily_field_history", "compiled": true, "compiled_code": "\n\nwith combined_field_histories as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__combine_field_histories\"\n\n    \n    where valid_starting_on >= (select max(valid_starting_on) from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__daily_field_history\" )\n    \n),\n\n\nlimit_to_relevant_fields as (\n\n-- let's remove unncessary rows moving forward and grab field names \n    select \n        combined_field_histories.*\n\n    from combined_field_histories\n\n    where lower(field_id) = 'status' \n            or lower(field_name) in ('sprint','summary','story points','components')\n    \n),\n\norder_daily_values as (\n\n    select \n        *,\n\n        -- want to grab last value for an issue's field for each day\n        row_number() over (\n            partition by valid_starting_on, issue_id, field_id\n            order by valid_starting_at desc\n            ) as row_num\n\n    from limit_to_relevant_fields\n),\n\n-- only looking at the latest value for each day\nget_latest_daily_value as (\n\n    select * \n    from order_daily_values\n\n    where row_num = 1\n), \n\nfinal as (\n\n    select\n        field_id,\n        issue_id,\n        field_name,\n\n        -- doing this to figure out what values are actually null and what needs to be backfilled in jira__daily_issue_field_history\n        case when field_value is null then 'is_null' else field_value end as field_value,\n        valid_starting_at,\n        valid_ending_at, \n        valid_starting_on,\n\n        md5(cast(coalesce(cast(field_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(issue_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_starting_on as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as issue_field_day_id\n        \n    from get_latest_daily_value\n)\n\nselect * from final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__daily_field_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.408182Z", "completed_at": "2024-03-21T15:31:52.414314Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.415796Z", "completed_at": "2024-03-21T15:31:52.415802Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012933015823364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__combine_field_histories_combined_history_id.943e81a794", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect combined_history_id\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__combine_field_histories\"\nwhere combined_history_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.416097Z", "completed_at": "2024-03-21T15:31:52.420930Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.428871Z", "completed_at": "2024-03-21T15:31:52.428880Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014831781387329102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__combine_field_histories_combined_history_id.5b6b492428", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    combined_history_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__combine_field_histories\"\nwhere combined_history_id is not null\ngroup by combined_history_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.421266Z", "completed_at": "2024-03-21T15:31:52.430345Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.431883Z", "completed_at": "2024-03-21T15:31:52.431894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015547990798950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.int_jira__pivot_daily_field_history", "compiled": true, "compiled_code": "\n\n-- latest value per issue field (already limited included fields to sprint, status, and var(issue_field_history_columns))\nwith daily_field_history as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__daily_field_history\"\n\n    \n    where valid_starting_on >= (select max(valid_starting_on) from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__pivot_daily_field_history\" )\n    \n),\n\npivot_out as (\n\n    -- pivot out default columns (status and sprint) and others specified in the var(issue_field_history_columns)\n    -- only days on which a field value was actively changed will have a non-null value. the nulls will need to \n    -- be backfilled in the final jira__daily_issue_field_history model\n    select \n        valid_starting_on, \n        issue_id,\n        max(case when lower(field_id) = 'status' then field_value end) as status,\n        max(case when lower(field_name) = 'sprint' then field_value end) as sprint\n\n        ,\n            max(case when lower(field_name) = 'summary' then field_value end) as summary\n        ,\n            max(case when lower(field_name) = 'story points' then field_value end) as story_points\n        ,\n            max(case when lower(field_name) = 'components' then field_value end) as components\n        from daily_field_history\n\n    group by 1,2\n),\n\nsurrogate_key as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(valid_starting_on as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(issue_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as issue_day_id\n\n    from pivot_out\n)\n\nselect * from surrogate_key", "relation_name": "\"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__pivot_daily_field_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.432299Z", "completed_at": "2024-03-21T15:31:52.440684Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.441360Z", "completed_at": "2024-03-21T15:31:52.441367Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011106252670288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__daily_field_history_issue_field_day_id.c910c3df84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_field_day_id\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__daily_field_history\"\nwhere issue_field_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.437539Z", "completed_at": "2024-03-21T15:31:52.442131Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.443368Z", "completed_at": "2024-03-21T15:31:52.443373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007591962814331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__daily_field_history_issue_field_day_id.bfd34ced78", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_field_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__daily_field_history\"\nwhere issue_field_day_id is not null\ngroup by issue_field_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.459519Z", "completed_at": "2024-03-21T15:31:52.463922Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.464558Z", "completed_at": "2024-03-21T15:31:52.464565Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007195234298706055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__pivot_daily_field_history_issue_day_id.b697c971fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_day_id\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__pivot_daily_field_history\"\nwhere issue_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.466596Z", "completed_at": "2024-03-21T15:31:52.470033Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.470559Z", "completed_at": "2024-03-21T15:31:52.470566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00523686408996582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__pivot_daily_field_history_issue_day_id.46c6f9a842", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__pivot_daily_field_history\"\nwhere issue_day_id is not null\ngroup by issue_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:51.953318Z", "completed_at": "2024-03-21T15:31:52.459206Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.463269Z", "completed_at": "2024-03-21T15:31:52.463277Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.537895917892456, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira_source.stg_jira__version", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    overdue\n    \n as \n    \n    overdue\n    \n, \n    \n    \n    project_id\n    \n as \n    \n    project_id\n    \n, \n    \n    \n    release_date\n    \n as \n    \n    release_date\n    \n, \n    \n    \n    released\n    \n as \n    \n    released\n    \n, \n    \n    \n    start_date\n    \n as \n    \n    start_date\n    \n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        archived as is_archived,\n        description,\n        id as version_id,\n        name as version_name,\n        overdue as is_overdue,\n        project_id,\n        cast(release_date as timestamp) as release_date,\n        released as is_released,\n        cast(start_date as timestamp) as start_date\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.492920Z", "completed_at": "2024-03-21T15:31:52.500214Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.501395Z", "completed_at": "2024-03-21T15:31:52.501404Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010702133178710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.not_null_stg_jira__version_version_id.03877ce324", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect version_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__version\"\nwhere version_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.496118Z", "completed_at": "2024-03-21T15:31:52.500600Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.501689Z", "completed_at": "2024-03-21T15:31:52.501693Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010921955108642578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira_source.unique_stg_jira__version_version_id.08231bd017", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    version_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__version\"\nwhere version_id is not null\ngroup by version_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.522944Z", "completed_at": "2024-03-21T15:31:52.527244Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.528570Z", "completed_at": "2024-03-21T15:31:52.528581Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011382818222045898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__issue_versions_issue_id.e2a88132de", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_jira__issue_multiselect_history as (\nwith issue_multiselect_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    issue_multiselect_history.*,\n    lower(fields.field_name) as field_name\n\n  from issue_multiselect_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_versions as (\n\n\nwith version as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__version\"\n),\n\nversion_history as (\n\n    select *\n    from __dbt__cte__int_jira__issue_multiselect_history\n\n    where field_id = 'versions'\n        or field_id = 'fixVersions'\n),\n\norder_versions as (\n\n    select\n        *,\n        -- using rank so batches stick together\n        rank() over (\n            partition by field_id, issue_id\n            order by updated_at desc\n            ) as row_num\n\n    from version_history\n),\n\nlatest_versions as (\n\n    select \n        field_id,\n        issue_id,\t\n        updated_at,\n        cast(field_value as integer) as version_id\n    from order_versions\n    where row_num = 1\n),\n\nversion_info as (\n\n    select \n        latest_versions.field_id,\n        latest_versions.issue_id,\n        \n    string_agg(version.version_name, ', ')\n\n as versions\n\n    from latest_versions\n    join version on latest_versions.version_id = version.version_id\n\n    group by 1,2\n),\n\nsplit_versions as (\n\n    select \n        issue_id,\n        case when field_id = 'versions' then versions else null end as affects_versions,\n        case when field_id = 'fixVersions' then versions else null end as fixes_versions\n    from version_info\n),\n\nfinal as (\n\n    select \n        issue_id,\n        max(affects_versions) as affects_versions,\n        max(fixes_versions) as fixes_versions\n    from split_versions\n    group by 1\n)\n\nselect *\nfrom final\n) select\n    issue_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_jira__issue_versions\nwhere issue_id is not null\ngroup by issue_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.519118Z", "completed_at": "2024-03-21T15:31:52.527631Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.528964Z", "completed_at": "2024-03-21T15:31:52.528969Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012577056884765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__issue_versions_issue_id.54c4cd445e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_jira__issue_multiselect_history as (\nwith issue_multiselect_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    issue_multiselect_history.*,\n    lower(fields.field_name) as field_name\n\n  from issue_multiselect_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_versions as (\n\n\nwith version as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__version\"\n),\n\nversion_history as (\n\n    select *\n    from __dbt__cte__int_jira__issue_multiselect_history\n\n    where field_id = 'versions'\n        or field_id = 'fixVersions'\n),\n\norder_versions as (\n\n    select\n        *,\n        -- using rank so batches stick together\n        rank() over (\n            partition by field_id, issue_id\n            order by updated_at desc\n            ) as row_num\n\n    from version_history\n),\n\nlatest_versions as (\n\n    select \n        field_id,\n        issue_id,\t\n        updated_at,\n        cast(field_value as integer) as version_id\n    from order_versions\n    where row_num = 1\n),\n\nversion_info as (\n\n    select \n        latest_versions.field_id,\n        latest_versions.issue_id,\n        \n    string_agg(version.version_name, ', ')\n\n as versions\n\n    from latest_versions\n    join version on latest_versions.version_id = version.version_id\n\n    group by 1,2\n),\n\nsplit_versions as (\n\n    select \n        issue_id,\n        case when field_id = 'versions' then versions else null end as affects_versions,\n        case when field_id = 'fixVersions' then versions else null end as fixes_versions\n    from version_info\n),\n\nfinal as (\n\n    select \n        issue_id,\n        max(affects_versions) as affects_versions,\n        max(fixes_versions) as fixes_versions\n    from split_versions\n    group by 1\n)\n\nselect *\nfrom final\n) select issue_id\nfrom __dbt__cte__int_jira__issue_versions\nwhere issue_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.678828Z", "completed_at": "2024-03-21T15:31:52.712481Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.713502Z", "completed_at": "2024-03-21T15:31:52.713513Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03866910934448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.int_jira__issue_join", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_jira__issue_users as (\n-- just grabs user attributes for issue assignees and reporters \n\nwith issue as (\n\n    -- including issue_id in here because snowflake for some reason ignores issue_id,\n    -- so we'll just always pull it out and explicitly select it\n    \n\n    select\n        issue_id,\n        coalesce(cast(revised_parent_issue_id as TEXT), cast(parent_issue_id as TEXT)) as parent_issue_id,\n\n        \"original_estimate_seconds\",\n  \"remaining_estimate_seconds\",\n  \"time_spent_seconds\",\n  \"assignee_user_id\",\n  \"created_at\",\n  \"resolved_at\",\n  \"creator_user_id\",\n  \"issue_description\",\n  \"due_date\",\n  \"environment\",\n  \"issue_type_id\",\n  \"issue_key\",\n  \"priority_id\",\n  \"project_id\",\n  \"reporter_user_id\",\n  \"resolution_id\",\n  \"status_id\",\n  \"status_changed_at\",\n  \"issue_name\",\n  \"updated_at\",\n  \"work_ratio\",\n  \"_fivetran_synced\",\n  \"issue_type\",\n  \"parent_issue_type\",\n  \"parent_issue_name\",\n  \"parent_issue_key\",\n  \"is_parent_epic\"\n\n\n    \n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_type_parents\"\n\n),\n\n-- user is a reserved keyword in AWS\njira_user as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\n),\n\nissue_user_join as (\n\n    select\n        issue.*,\n        assignee.user_display_name as assignee_name,\n        assignee.time_zone as assignee_timezone,\n        assignee.email as assignee_email,\n        reporter.email as reporter_email,\n        reporter.user_display_name as reporter_name,\n        reporter.time_zone as reporter_timezone\n        \n        \n    from issue\n    left join jira_user as assignee on issue.assignee_user_id = assignee.user_id \n    left join jira_user as reporter on issue.reporter_user_id = reporter.user_id\n\n)\n\nselect * \nfrom issue_user_join\n),  __dbt__cte__int_jira__issue_multiselect_history as (\nwith issue_multiselect_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_multiselect_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    issue_multiselect_history.*,\n    lower(fields.field_name) as field_name\n\n  from issue_multiselect_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_sprint as (\n\n\nwith sprint as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__sprint\"\n\n),\n\nfield_history as (\n\n     -- sprints don't appear to be capable of multiselect in the UI...\n    select *\n    from __dbt__cte__int_jira__issue_multiselect_history\n\n),\n\nsprint_field_history as (\n\n    select \n        field_history.*,\n        sprint.*,\n        row_number() over (\n                    partition by field_history.issue_id \n                    order by field_history.updated_at desc, sprint.started_at desc         \n                    ) as row_num\n    from field_history\n    join sprint on field_history.field_value = cast(sprint.sprint_id as TEXT)\n    where lower(field_history.field_name) = 'sprint'\n),\n\n\nlast_sprint as (\n\n    select *\n    from sprint_field_history\n    \n    where row_num = 1\n\n), \n\nsprint_rollovers as (\n\n    select \n        issue_id,\n        count(distinct case when field_value is not null then field_value end) as count_sprint_changes\n    \n    from sprint_field_history\n    group by 1\n\n),\n\nissue_sprint as (\n\n    select \n        last_sprint.issue_id,\n        last_sprint.field_value as current_sprint_id,\n        last_sprint.sprint_name as current_sprint_name,\n        last_sprint.board_id,\n        last_sprint.started_at as sprint_started_at,\n        last_sprint.ended_at as sprint_ended_at,\n        last_sprint.completed_at as sprint_completed_at,\n        coalesce(sprint_rollovers.count_sprint_changes, 0) as count_sprint_changes\n\n    from \n    last_sprint \n    left join sprint_rollovers on sprint_rollovers.issue_id = last_sprint.issue_id\n    \n)\n\nselect * from issue_sprint\n),  __dbt__cte__int_jira__issue_comments as (\n\n\nwith comment as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__comment\"\n\n    order by issue_id, created_at asc\n\n),\n\n-- user is a reserved keyword in AWS \njira_user as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\n),\n\nagg_comments as (\n\n    select \n    comment.issue_id,\n    \n    string_agg(comment.created_at || '  -  ' || jira_user.user_display_name || ':  ' || comment.body, '\\n')\n\n as conversation,\n    count(comment.comment_id) as count_comments\n\n    from\n    comment \n    join jira_user on comment.author_user_id = jira_user.user_id\n\n    group by 1\n)\n\nselect * from agg_comments\n),  __dbt__cte__int_jira__issue_field_history as (\nwith field_history as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_field_history\"\n    \n), \n\nfields as (\n      \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field\"\n\n), \n\njoined as (\n  \n  select\n    field_history.*,\n    lower(fields.field_name) as field_name\n\n  from field_history\n  join fields using (field_id)\n\n)\n\nselect *\nfrom joined\n),  __dbt__cte__int_jira__issue_assign_resolution as (\nwith issue_field_history as (\n    \n    select *\n    from __dbt__cte__int_jira__issue_field_history\n\n), \n\nfiltered as (\n    -- we're only looking at assignments and resolutions, which are single-field values\n    select *\n    from issue_field_history\n\n    where (lower(field_id) = 'assignee'\n    or lower(field_id) = 'resolutiondate')\n\n    and field_value is not null -- remove initial null rows\n),\n\nissue_dates as (\n\n    select\n\n        issue_id,\n        min(case when field_id = 'assignee' then updated_at end) as first_assigned_at,\n        max(case when field_id = 'assignee' then updated_at end) as last_assigned_at,\n        min(case when field_id = 'resolutiondate' then updated_at end) as first_resolved_at -- in case it's been re-opened\n\n    from filtered\n    group by 1\n)\n\nselect *\nfrom issue_dates\n),  __dbt__cte__int_jira__issue_versions as (\n\n\nwith version as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__version\"\n),\n\nversion_history as (\n\n    select *\n    from __dbt__cte__int_jira__issue_multiselect_history\n\n    where field_id = 'versions'\n        or field_id = 'fixVersions'\n),\n\norder_versions as (\n\n    select\n        *,\n        -- using rank so batches stick together\n        rank() over (\n            partition by field_id, issue_id\n            order by updated_at desc\n            ) as row_num\n\n    from version_history\n),\n\nlatest_versions as (\n\n    select \n        field_id,\n        issue_id,\t\n        updated_at,\n        cast(field_value as integer) as version_id\n    from order_versions\n    where row_num = 1\n),\n\nversion_info as (\n\n    select \n        latest_versions.field_id,\n        latest_versions.issue_id,\n        \n    string_agg(version.version_name, ', ')\n\n as versions\n\n    from latest_versions\n    join version on latest_versions.version_id = version.version_id\n\n    group by 1,2\n),\n\nsplit_versions as (\n\n    select \n        issue_id,\n        case when field_id = 'versions' then versions else null end as affects_versions,\n        case when field_id = 'fixVersions' then versions else null end as fixes_versions\n    from version_info\n),\n\nfinal as (\n\n    select \n        issue_id,\n        max(affects_versions) as affects_versions,\n        max(fixes_versions) as fixes_versions\n    from split_versions\n    group by 1\n)\n\nselect *\nfrom final\n), issue as (\n\n    select *\n    from __dbt__cte__int_jira__issue_users\n\n),\n\nproject as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__project\"\n),\n\nstatus as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status\"\n),\n\nstatus_category as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status_category\"\n),\n\nresolution as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__resolution\"\n),\n\n\npriority as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__priority\"\n),\n\n\n\nissue_sprint as (\n\n    select *\n    from __dbt__cte__int_jira__issue_sprint\n),\n\n\n\nissue_comments as (\n\n    select * \n    from __dbt__cte__int_jira__issue_comments\n),\n\n\nissue_assignments_and_resolutions as (\n  \n  select *\n  from __dbt__cte__int_jira__issue_assign_resolution\n\n),\n\n\nissue_versions as (\n\n    select *\n    from __dbt__cte__int_jira__issue_versions\n),\n\n\njoin_issue as (\n\n    select\n        issue.* \n\n        ,project.project_name as project_name\n\n        ,status.status_name as current_status\n        ,status_category.status_category_name as current_status_category   \n        ,resolution.resolution_name as resolution_type\n        \n        ,priority.priority_name as current_priority\n\t\n\n        \n        ,issue_sprint.current_sprint_id\n        ,issue_sprint.current_sprint_name\n        ,coalesce(issue_sprint.count_sprint_changes, 0) as count_sprint_changes\n        ,issue_sprint.sprint_started_at\n        ,issue_sprint.sprint_ended_at\n        ,issue_sprint.sprint_completed_at\n        ,coalesce(issue_sprint.sprint_started_at <= \n    current_timestamp::timestamp\n\n          and coalesce(issue_sprint.sprint_completed_at, \n    current_timestamp::timestamp\n) >= \n    current_timestamp::timestamp\n  \n          , false) as is_active_sprint -- If sprint doesn't have a start date, default to false. If it does have a start date, but no completed date, this means that the sprint is active. The ended_at timestamp is irrelevant here.\n        \n\n        ,issue_assignments_and_resolutions.first_assigned_at\n        ,issue_assignments_and_resolutions.last_assigned_at\n        ,issue_assignments_and_resolutions.first_resolved_at\n\n        \n        ,issue_versions.fixes_versions\n        ,issue_versions.affects_versions\n        \n\n        \n        ,issue_comments.conversation\n        ,coalesce(issue_comments.count_comments, 0) as count_comments\n        \n    \n    from issue\n    left join project on project.project_id = issue.project_id\n    left join status on status.status_id = issue.status_id\n    left join status_category on status.status_category_id = status_category.status_category_id\n    left join resolution on resolution.resolution_id = issue.resolution_id\n\t\n    left join priority on priority.priority_id = issue.priority_id\n\t\n    left join issue_assignments_and_resolutions on issue_assignments_and_resolutions.issue_id = issue.issue_id\n\n    \n    left join issue_versions on issue_versions.issue_id = issue.issue_id\n    \n    \n    \n    left join issue_sprint on issue_sprint.issue_id = issue.issue_id\n    \n\n    \n    left join issue_comments on issue_comments.issue_id = issue.issue_id\n    \n)\n\nselect * \nfrom join_issue", "relation_name": "\"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_join\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.703030Z", "completed_at": "2024-03-21T15:31:52.713190Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.716224Z", "completed_at": "2024-03-21T15:31:52.716231Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04056501388549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__issue_users_issue_id.480b7b6beb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_jira__issue_users as (\n-- just grabs user attributes for issue assignees and reporters \n\nwith issue as (\n\n    -- including issue_id in here because snowflake for some reason ignores issue_id,\n    -- so we'll just always pull it out and explicitly select it\n    \n\n    select\n        issue_id,\n        coalesce(cast(revised_parent_issue_id as TEXT), cast(parent_issue_id as TEXT)) as parent_issue_id,\n\n        \"original_estimate_seconds\",\n  \"remaining_estimate_seconds\",\n  \"time_spent_seconds\",\n  \"assignee_user_id\",\n  \"created_at\",\n  \"resolved_at\",\n  \"creator_user_id\",\n  \"issue_description\",\n  \"due_date\",\n  \"environment\",\n  \"issue_type_id\",\n  \"issue_key\",\n  \"priority_id\",\n  \"project_id\",\n  \"reporter_user_id\",\n  \"resolution_id\",\n  \"status_id\",\n  \"status_changed_at\",\n  \"issue_name\",\n  \"updated_at\",\n  \"work_ratio\",\n  \"_fivetran_synced\",\n  \"issue_type\",\n  \"parent_issue_type\",\n  \"parent_issue_name\",\n  \"parent_issue_key\",\n  \"is_parent_epic\"\n\n\n    \n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_type_parents\"\n\n),\n\n-- user is a reserved keyword in AWS\njira_user as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\n),\n\nissue_user_join as (\n\n    select\n        issue.*,\n        assignee.user_display_name as assignee_name,\n        assignee.time_zone as assignee_timezone,\n        assignee.email as assignee_email,\n        reporter.email as reporter_email,\n        reporter.user_display_name as reporter_name,\n        reporter.time_zone as reporter_timezone\n        \n        \n    from issue\n    left join jira_user as assignee on issue.assignee_user_id = assignee.user_id \n    left join jira_user as reporter on issue.reporter_user_id = reporter.user_id\n\n)\n\nselect * \nfrom issue_user_join\n) select issue_id\nfrom __dbt__cte__int_jira__issue_users\nwhere issue_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.707077Z", "completed_at": "2024-03-21T15:31:52.714058Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.717155Z", "completed_at": "2024-03-21T15:31:52.717159Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04198098182678223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__issue_users_issue_id.e3a5962431", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_jira__issue_users as (\n-- just grabs user attributes for issue assignees and reporters \n\nwith issue as (\n\n    -- including issue_id in here because snowflake for some reason ignores issue_id,\n    -- so we'll just always pull it out and explicitly select it\n    \n\n    select\n        issue_id,\n        coalesce(cast(revised_parent_issue_id as TEXT), cast(parent_issue_id as TEXT)) as parent_issue_id,\n\n        \"original_estimate_seconds\",\n  \"remaining_estimate_seconds\",\n  \"time_spent_seconds\",\n  \"assignee_user_id\",\n  \"created_at\",\n  \"resolved_at\",\n  \"creator_user_id\",\n  \"issue_description\",\n  \"due_date\",\n  \"environment\",\n  \"issue_type_id\",\n  \"issue_key\",\n  \"priority_id\",\n  \"project_id\",\n  \"reporter_user_id\",\n  \"resolution_id\",\n  \"status_id\",\n  \"status_changed_at\",\n  \"issue_name\",\n  \"updated_at\",\n  \"work_ratio\",\n  \"_fivetran_synced\",\n  \"issue_type\",\n  \"parent_issue_type\",\n  \"parent_issue_name\",\n  \"parent_issue_key\",\n  \"is_parent_epic\"\n\n\n    \n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_type_parents\"\n\n),\n\n-- user is a reserved keyword in AWS\njira_user as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\n),\n\nissue_user_join as (\n\n    select\n        issue.*,\n        assignee.user_display_name as assignee_name,\n        assignee.time_zone as assignee_timezone,\n        assignee.email as assignee_email,\n        reporter.email as reporter_email,\n        reporter.user_display_name as reporter_name,\n        reporter.time_zone as reporter_timezone\n        \n        \n    from issue\n    left join jira_user as assignee on issue.assignee_user_id = assignee.user_id \n    left join jira_user as reporter on issue.reporter_user_id = reporter.user_id\n\n)\n\nselect * \nfrom issue_user_join\n) select\n    issue_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_jira__issue_users\nwhere issue_id is not null\ngroup by issue_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.721432Z", "completed_at": "2024-03-21T15:31:52.728650Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.729402Z", "completed_at": "2024-03-21T15:31:52.729410Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011762142181396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__issue_join_issue_id.53391b21a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_id\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_join\"\nwhere issue_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.725366Z", "completed_at": "2024-03-21T15:31:52.729667Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.731152Z", "completed_at": "2024-03-21T15:31:52.731159Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010895729064941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__issue_join_issue_id.0bd360ec4b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_join\"\nwhere issue_id is not null\ngroup by issue_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.444803Z", "completed_at": "2024-03-21T15:31:52.753273Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.753905Z", "completed_at": "2024-03-21T15:31:52.753914Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3392329216003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.int_jira__field_history_scd", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__pivot_daily_field_history\"\n\n), set_values as (\n\n    select \n        valid_starting_on, \n        issue_id,\n        issue_day_id,\n        status as status_id,\n        sum( case when status is null then 0 else 1 end) over ( partition by issue_id \n            order by valid_starting_on rows unbounded preceding) as status_id_field_partition\n\n         \n        , status\n        -- create a batch/partition once a new value is provided\n        , sum( case when status is null then 0 else 1 end) over ( partition by issue_id \n            order by valid_starting_on rows unbounded preceding) as status_field_partition\n\n         \n        , sprint\n        -- create a batch/partition once a new value is provided\n        , sum( case when sprint is null then 0 else 1 end) over ( partition by issue_id \n            order by valid_starting_on rows unbounded preceding) as sprint_field_partition\n\n         \n        , summary\n        -- create a batch/partition once a new value is provided\n        , sum( case when summary is null then 0 else 1 end) over ( partition by issue_id \n            order by valid_starting_on rows unbounded preceding) as summary_field_partition\n\n         \n        , story_points\n        -- create a batch/partition once a new value is provided\n        , sum( case when story_points is null then 0 else 1 end) over ( partition by issue_id \n            order by valid_starting_on rows unbounded preceding) as story_points_field_partition\n\n         \n        , components\n        -- create a batch/partition once a new value is provided\n        , sum( case when components is null then 0 else 1 end) over ( partition by issue_id \n            order by valid_starting_on rows unbounded preceding) as components_field_partition\n\n        \n    \n    from change_data\n\n), fill_values as (\n\n-- each row of the pivoted table includes field values if that field was updated on that day\n-- we need to backfill to persist values that have been previously updated and are still valid \n    select \n        valid_starting_on, \n        issue_id,\n        issue_day_id,\n        first_value( status ) over (\n            partition by issue_id, status_id_field_partition \n            order by valid_starting_on asc rows between unbounded preceding and current row) as status_id\n        \n         \n\n        -- grab the value that started this batch/partition\n        , first_value( status ) over (\n            partition by issue_id, status_field_partition \n            order by valid_starting_on asc rows between unbounded preceding and current row) as status\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( sprint ) over (\n            partition by issue_id, sprint_field_partition \n            order by valid_starting_on asc rows between unbounded preceding and current row) as sprint\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( summary ) over (\n            partition by issue_id, summary_field_partition \n            order by valid_starting_on asc rows between unbounded preceding and current row) as summary\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( story_points ) over (\n            partition by issue_id, story_points_field_partition \n            order by valid_starting_on asc rows between unbounded preceding and current row) as story_points\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( components ) over (\n            partition by issue_id, components_field_partition \n            order by valid_starting_on asc rows between unbounded preceding and current row) as components\n\n        \n\n    from set_values\n\n)\n\nselect *\nfrom fill_values", "relation_name": "\"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__field_history_scd\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.798234Z", "completed_at": "2024-03-21T15:31:52.801714Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.803016Z", "completed_at": "2024-03-21T15:31:52.803024Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0189361572265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__field_history_scd_issue_day_id.21b932e949", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__field_history_scd\"\nwhere issue_day_id is not null\ngroup by issue_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.795113Z", "completed_at": "2024-03-21T15:31:52.802118Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:52.803313Z", "completed_at": "2024-03-21T15:31:52.803318Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01984095573425293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__field_history_scd_issue_day_id.327ac0856c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_day_id\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__field_history_scd\"\nwhere issue_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:52.785420Z", "completed_at": "2024-03-21T15:31:53.092371Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.092920Z", "completed_at": "2024-03-21T15:31:53.092928Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3341810703277588, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.int_jira__issue_calendar_spine", "compiled": true, "compiled_code": "\n\nwith spine as (\n\n    \n    \n    \n    \n    \n\n\n    select * \n    from (\n        \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1457\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2020-04-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= \n\n    \n    (current_timestamp at time zone 'utc')::timestamp\n + ((interval '1 week') * (1))\n\n\n\n)\n\nselect * from filtered\n\n \n    ) as date_spine\n\n    \n    -- compare to the earliest possible open_until date so that if a resolved issue is updated after a long period of inactivity, we don't need a full refresh\n    -- essentially we need to be able to backfill\n    where cast( date_day as date) >= (select min(earliest_open_until_date) from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_calendar_spine\" )\n    \n),\n\nissue_history_scd as (\n    \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__field_history_scd\"\n),\n\nissue_dates as (\n\n    select\n        issue_history_scd.issue_id,\n        cast( date_trunc('day', issue.created_at) as date) as created_on,\n        -- resolved_at will become null if an issue is marked as un-resolved. if this sorta thing happens often, you may want to run full-refreshes of the field_history models often\n        -- if it's not resolved include everything up to today. if it is, look at the last time it was updated \n        cast(date_trunc('day', case when issue.resolved_at is null then \n    (current_timestamp at time zone 'utc')::timestamp\n else cast(issue_history_scd.valid_starting_on as timestamp) end) as date) as open_until\n    from issue_history_scd\n    left join \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue\" as issue\n        on issue_history_scd.issue_id = issue.issue_id\n),\n\nissue_spine as (\n\n    select \n        cast(spine.date_day as date) as date_day,\n        issue_dates.issue_id,\n        -- will take the table-wide min of this in the incremental block at the top of this model\n        min(issue_dates.open_until) as earliest_open_until_date\n\n    from spine \n    join issue_dates on\n        issue_dates.created_on <= spine.date_day\n        and \n\n    issue_dates.open_until + ((interval '1 month') * (1))\n\n >= spine.date_day\n        -- if we cut off issues, we're going to have to do a full refresh to catch issues that have been un-resolved\n\n    group by 1,2\n),\n\nsurrogate_key as (\n\n    select \n        date_day,\n        issue_id,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(issue_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as issue_day_id,\n        earliest_open_until_date\n\n    from issue_spine\n\n    where date_day <= cast( date_trunc('day', \n    (current_timestamp at time zone 'utc')::timestamp\n) as date)\n)\nselect * from surrogate_key", "relation_name": "\"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_calendar_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.139660Z", "completed_at": "2024-03-21T15:31:53.146816Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.147956Z", "completed_at": "2024-03-21T15:31:53.147966Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029191970825195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__issue_calendar_spine_issue_day_id.a9512b8e8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_day_id\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_calendar_spine\"\nwhere issue_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.143094Z", "completed_at": "2024-03-21T15:31:53.147551Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.149172Z", "completed_at": "2024-03-21T15:31:53.149177Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027553081512451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__issue_calendar_spine_issue_day_id.c49483d2e5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_calendar_spine\"\nwhere issue_day_id is not null\ngroup by issue_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.123666Z", "completed_at": "2024-03-21T15:31:53.465949Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.466472Z", "completed_at": "2024-03-21T15:31:53.466478Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.37749600410461426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.jira__daily_issue_field_history", "compiled": true, "compiled_code": "\n\n-- grab column names that were pivoted out-- in intermediate/field_history/\nwith pivoted_daily_history as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__field_history_scd\"\n\n    \n    \n    where valid_starting_on >= (select max(date_day) from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__daily_issue_field_history\" )\n\n-- If no issue fields have been updated since the last incremental run, the pivoted_daily_history CTE will return no record/rows.\n-- When this is the case, we need to grab the most recent day's records from the previously built table so that we can persist \n-- those values into the future.\n\n), most_recent_data as ( \n    select \n        *\n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__daily_issue_field_history\"\n    where date_day = (select max(date_day) from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__daily_issue_field_history\" )\n\n\n\n), field_option as (\n    \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__field_option\"\n),\n\nstatuses as (\n    \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__status\"\n),\n\nissue_types as (\n    \n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__issue_type\"\n),\n\n\ncomponents as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__component\"\n),\n\n\n-- in intermediate/field_history/\ncalendar as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_calendar_spine\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__daily_issue_field_history\" )\n    \n),\n\njoined as (\n\n    select\n        calendar.date_day,\n        calendar.issue_id\n\n            \n            \n                \n            \n                \n            \n                \n            \n                 \n                , coalesce(pivoted_daily_history.status_id, most_recent_data.status_id) as status_id\n\n                \n            \n                 \n                , coalesce(pivoted_daily_history.status, most_recent_data.status) as status\n\n                \n            \n                 \n                , coalesce(pivoted_daily_history.sprint, most_recent_data.sprint) as sprint\n\n                \n            \n                 \n                , coalesce(pivoted_daily_history.summary, most_recent_data.summary) as summary\n\n                \n            \n                 \n                , coalesce(pivoted_daily_history.story_points, most_recent_data.story_points) as story_points\n\n                \n            \n                \n                , coalesce(pivoted_daily_history.components, most_recent_data.components) as components\n\n                \n             \n\n        \n    \n    from calendar\n    left join pivoted_daily_history \n        on calendar.issue_id = pivoted_daily_history.issue_id\n        and calendar.date_day = pivoted_daily_history.valid_starting_on\n    \n    \n    left join most_recent_data\n        on calendar.issue_id = most_recent_data.issue_id\n        and calendar.date_day = most_recent_data.date_day\n    \n),\n\nset_values as (\n    select\n        date_day,\n        issue_id,\n        joined.status_id,\n        sum( case when joined.status_id is null then 0 else 1 end) over ( partition by issue_id\n            order by date_day rows unbounded preceding) as status_id_field_partition\n\n        -- list of exception columns\n        \n\n        \n            \n        \n            \n        \n            \n        \n            \n        \n            \n        \n            \n            , coalesce(field_option_sprint.field_option_name, joined.sprint) as sprint\n            -- create a batch/partition once a new value is provided\n            , sum( case when joined.sprint is null then 0 else 1 end) over ( partition by issue_id\n                order by date_day rows unbounded preceding) as sprint_field_partition\n\n            \n        \n            \n            , coalesce(field_option_summary.field_option_name, joined.summary) as summary\n            -- create a batch/partition once a new value is provided\n            , sum( case when joined.summary is null then 0 else 1 end) over ( partition by issue_id\n                order by date_day rows unbounded preceding) as summary_field_partition\n\n            \n        \n            \n            , coalesce(field_option_story_points.field_option_name, joined.story_points) as story_points\n            -- create a batch/partition once a new value is provided\n            , sum( case when joined.story_points is null then 0 else 1 end) over ( partition by issue_id\n                order by date_day rows unbounded preceding) as story_points_field_partition\n\n            \n        \n            \n            , coalesce(components.component_name, joined.components) as components\n            , sum(case when joined.components is null then 0 else 1 end) over (partition by issue_id order by date_day rows unbounded preceding) as component_field_partition\n\n            \n        \n\n    from joined\n\n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n    \n        \n        left join field_option as field_option_sprint\n            on cast(field_option_sprint.field_id as TEXT) = joined.sprint\n\n        \n    \n        \n        left join field_option as field_option_summary\n            on cast(field_option_summary.field_id as TEXT) = joined.summary\n\n        \n    \n        \n        left join field_option as field_option_story_points\n            on cast(field_option_story_points.field_id as TEXT) = joined.story_points\n\n        \n    \n        \n        left join components   \n            on cast(components.component_id as TEXT) = joined.components\n        \n        \n    \n),\n\nfill_values as (\n\n    select  \n        date_day,\n        issue_id,\n        first_value( status_id ) over (\n            partition by issue_id, status_id_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as status_id\n\n        \n            \n        \n            \n        \n            \n        \n            \n        \n            \n        \n            \n            -- grab the value that started this batch/partition\n            , first_value( sprint ) over (\n                partition by issue_id, sprint_field_partition \n                order by date_day asc rows between unbounded preceding and current row) as sprint\n\n            \n        \n            \n            -- grab the value that started this batch/partition\n            , first_value( summary ) over (\n                partition by issue_id, summary_field_partition \n                order by date_day asc rows between unbounded preceding and current row) as summary\n\n            \n        \n            \n            -- grab the value that started this batch/partition\n            , first_value( story_points ) over (\n                partition by issue_id, story_points_field_partition \n                order by date_day asc rows between unbounded preceding and current row) as story_points\n\n            \n        \n            \n            , first_value(components) over (\n                partition by issue_id, component_field_partition \n                order by date_day asc rows between unbounded preceding and current row) as components\n\n            \n        \n\n    from set_values\n),\n\nfix_null_values as (\n\n    select  \n        date_day,\n        issue_id\n\n        \n            \n        \n            \n        \n            \n        \n            \n            -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n            , case when status_id = 'is_null' then null else status_id end as status_id\n\n            \n        \n            \n        \n            \n            -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n            , case when sprint = 'is_null' then null else sprint end as sprint\n\n            \n        \n            \n            -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n            , case when summary = 'is_null' then null else summary end as summary\n\n            \n        \n            \n            -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n            , case when story_points = 'is_null' then null else story_points end as story_points\n\n            \n        \n            \n            , case when components = 'is_null' then null else components end as components\n\n            \n        \n\n    from fill_values\n\n),\n\nsurrogate_key as (\n\n    select\n        fix_null_values.date_day,\n        fix_null_values.issue_id,\n        statuses.status_name as status\n\n        \n            \n        \n            \n        \n            \n        \n             \n            , fix_null_values.status_id as status_id\n\n            \n        \n            \n        \n             \n            , fix_null_values.sprint as sprint\n\n            \n        \n             \n            , fix_null_values.summary as summary\n\n            \n        \n             \n            , fix_null_values.story_points as story_points\n\n            \n        \n            \n            , fix_null_values.components as components\n\n            \n        \n\n        , md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(issue_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as issue_day_id\n\n    from fix_null_values\n\n    left join statuses\n        on cast(statuses.status_id as TEXT) = fix_null_values.status_id\n)\n\nselect *\nfrom surrogate_key", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira\".\"jira__daily_issue_field_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.523498Z", "completed_at": "2024-03-21T15:31:53.529644Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.530918Z", "completed_at": "2024-03-21T15:31:53.530925Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023799896240234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_jira__daily_issue_field_history_issue_day_id.d13b058bcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_day_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__daily_issue_field_history\"\nwhere issue_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.526148Z", "completed_at": "2024-03-21T15:31:53.530084Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.531189Z", "completed_at": "2024-03-21T15:31:53.531193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022655010223388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_jira__daily_issue_field_history_issue_day_id.75c24d3154", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__daily_issue_field_history\"\nwhere issue_day_id is not null\ngroup by issue_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.513316Z", "completed_at": "2024-03-21T15:31:53.828952Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.829491Z", "completed_at": "2024-03-21T15:31:53.829498Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.35710787773132324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.jira__issue_enhanced", "compiled": true, "compiled_code": "with issue as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_int_jira\".\"int_jira__issue_join\"\n),daily_issue_field_history as (\n    \n    select\n        *,\n        row_number() over (partition by issue_id order by date_day desc) = 1 as latest_record\n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__daily_issue_field_history\"\n\n),\n\nlatest_issue_field_history as (\n    \n    select\n        *\n    from daily_issue_field_history\n    where latest_record\n),\n\nfinal as (\n\n    select \n    \n        issue.*,\n\n        \n        (\n        (\n        (\n        ((coalesce(resolved_at, \n    current_timestamp::timestamp\n))::date - (created_at)::date)\n     * 24 + date_part('hour', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp) - date_part('hour', (created_at)::timestamp))\n     * 60 + date_part('minute', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp) - date_part('minute', (created_at)::timestamp))\n     * 60 + floor(date_part('second', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp)) - floor(date_part('second', (created_at)::timestamp)))\n     open_duration_seconds,\n\n        -- this will be null if no one has been assigned\n        \n        (\n        (\n        (\n        ((coalesce(resolved_at, \n    current_timestamp::timestamp\n))::date - (first_assigned_at)::date)\n     * 24 + date_part('hour', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp) - date_part('hour', (first_assigned_at)::timestamp))\n     * 60 + date_part('minute', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp) - date_part('minute', (first_assigned_at)::timestamp))\n     * 60 + floor(date_part('second', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp)) - floor(date_part('second', (first_assigned_at)::timestamp)))\n     any_assignment_duration_seconds,\n\n        -- if an issue is not currently assigned this will not be null\n        \n        (\n        (\n        (\n        ((coalesce(resolved_at, \n    current_timestamp::timestamp\n))::date - (last_assigned_at)::date)\n     * 24 + date_part('hour', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp) - date_part('hour', (last_assigned_at)::timestamp))\n     * 60 + date_part('minute', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp) - date_part('minute', (last_assigned_at)::timestamp))\n     * 60 + floor(date_part('second', (coalesce(resolved_at, \n    current_timestamp::timestamp\n))::timestamp)) - floor(date_part('second', (last_assigned_at)::timestamp)))\n     last_assignment_duration_seconds \n\n        , status, sprint, summary, story_points, components\n\n    from issue\n    \n    left join latest_issue_field_history \n        on issue.issue_id = latest_issue_field_history.issue_id\n        \n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.887892Z", "completed_at": "2024-03-21T15:31:53.895964Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.898886Z", "completed_at": "2024-03-21T15:31:53.898892Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03207969665527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_jira__issue_enhanced_issue_id.6b18e0db38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect issue_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\"\nwhere issue_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.891128Z", "completed_at": "2024-03-21T15:31:53.896276Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.899215Z", "completed_at": "2024-03-21T15:31:53.899219Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0318453311920166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_jira__issue_enhanced_issue_id.fec6e723ee", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    issue_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\"\nwhere issue_id is not null\ngroup by issue_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.901522Z", "completed_at": "2024-03-21T15:31:53.923245Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.938258Z", "completed_at": "2024-03-21T15:31:53.938271Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04141497611999512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.jira__project_enhanced", "compiled": true, "compiled_code": "with  __dbt__cte__int_jira__project_metrics as (\nwith issue as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\"\n    where project_id is not null\n),\n\ncalculate_medians as (\n\n    select \n        project_id,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then open_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_close_time_seconds,\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then open_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_age_currently_open_seconds,\n\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then any_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_assigned_close_time_seconds,\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then any_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_age_currently_open_assigned_seconds\n\n    from issue\n\n     group by project_id \n),\n\n-- grouping because the medians were calculated using window functions (except in postgres)\nmedian_metrics as (\n\n    select \n        project_id, \n        median_close_time_seconds, \n        median_age_currently_open_seconds,\n        median_assigned_close_time_seconds,\n        median_age_currently_open_assigned_seconds\n\n    from calculate_medians\n    group by 1,2,3,4,5\n),\n\n\n-- get appropriate counts + sums to calculate averages\nproject_issues as (\n    select\n        project_id,\n        sum(case when resolved_at is not null then 1 else 0 end) as count_closed_issues,\n        sum(case when resolved_at is null then 1 else 0 end) as count_open_issues,\n\n        -- using the below to calculate averages\n\n        -- assigned issues\n        sum(case when resolved_at is null and assignee_user_id is not null then 1 else 0 end) as count_open_assigned_issues,\n        sum(case when resolved_at is not null and assignee_user_id is not null then 1 else 0 end) as count_closed_assigned_issues,\n\n        -- close time \n        sum(case when resolved_at is not null then open_duration_seconds else 0 end) as sum_close_time_seconds,\n        sum(case when resolved_at is not null then any_assignment_duration_seconds else 0 end) as sum_assigned_close_time_seconds,\n\n        -- age of currently open tasks\n        sum(case when resolved_at is null then open_duration_seconds else 0 end) as sum_currently_open_duration_seconds,\n        sum(case when resolved_at is null then any_assignment_duration_seconds else 0 end) as sum_currently_open_assigned_duration_seconds\n\n    from issue\n\n    group by 1\n),\n\ncalculate_avg_metrics as (\n\n    select\n        project_id,\n        count_closed_issues,\n        count_open_issues,\n        count_open_assigned_issues,\n\n        case when count_closed_issues = 0 then 0 else\n        round( cast(sum_close_time_seconds * 1.0 / count_closed_issues  as numeric(28,6) ), 0) end as avg_close_time_seconds,\n\n        case when count_closed_assigned_issues = 0 then 0 else\n        round( cast(sum_assigned_close_time_seconds * 1.0 / count_closed_assigned_issues  as numeric(28,6) ), 0) end as avg_assigned_close_time_seconds,\n\n        case when count_open_issues = 0 then 0 else\n        round( cast(sum_currently_open_duration_seconds * 1.0 / count_open_issues as numeric(28,6) ), 0) end as avg_age_currently_open_seconds,\n\n        case when count_open_assigned_issues = 0 then 0 else\n        round( cast(sum_currently_open_assigned_duration_seconds * 1.0 / count_open_assigned_issues as numeric(28,6) ), 0) end as avg_age_currently_open_assigned_seconds\n\n    from project_issues\n),\n\n-- join medians and averages + convert to days\njoin_metrics as (\n\n    select\n        calculate_avg_metrics.*,\n\n        -- there are 86400 seconds in a day\n        round( cast(calculate_avg_metrics.avg_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_close_time_days,\n        round( cast(calculate_avg_metrics.avg_assigned_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_assigned_close_time_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_assigned_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_assigned_days,\n\n        median_metrics.median_close_time_seconds, \n        median_metrics.median_age_currently_open_seconds,\n        median_metrics.median_assigned_close_time_seconds,\n        median_metrics.median_age_currently_open_assigned_seconds,\n\n        round( cast(median_metrics.median_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_days,\n        round( cast(median_metrics.median_assigned_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_assigned_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_assigned_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_assigned_days\n        \n    from calculate_avg_metrics\n    left join median_metrics using(project_id)\n)\n\nselect * from join_metrics\n), project as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__project\"\n),\n\nproject_metrics as (\n\n    select * \n    from __dbt__cte__int_jira__project_metrics\n),\n\n-- user is reserved in AWS\njira_user as (\n-- to grab the project lead\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\n),\n\nagg_epics as (\n\n    select \n        project_id,\n        \n    string_agg(issue_name, ', ')\n\n as epics\n\n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\"\n    where lower(issue_type) = 'epic'\n    -- should we limit to active epics?\n    group by 1\n\n),\n\n\n\nagg_components as (\n    -- i'm just aggregating the components here, but perhaps pivoting out components (and epics) \n    -- into columns where the values are the number of issues completed and/or open would be more valuable\n    select \n        project_id,\n        \n    string_agg(component_name, ', ')\n\n as components\n\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__component\"\n\n    group by 1\n),\n\n\n\nproject_join as (\n\n    select\n        project.*,\n        jira_user.user_display_name as project_lead_user_name,\n        jira_user.email as project_lead_email,\n        agg_epics.epics,\n        \n        \n        agg_components.components,\n        \n\n        coalesce(project_metrics.count_closed_issues, 0) as count_closed_issues,\n        coalesce(project_metrics.count_open_issues, 0) as count_open_issues,\n        coalesce(project_metrics.count_open_assigned_issues, 0) as count_open_assigned_issues,\n\n        -- days\n        project_metrics.avg_close_time_days,\n        project_metrics.avg_assigned_close_time_days,\n\n        project_metrics.avg_age_currently_open_days,\n        project_metrics.avg_age_currently_open_assigned_days,\n\n        project_metrics.median_close_time_days, \n        project_metrics.median_age_currently_open_days,\n        project_metrics.median_assigned_close_time_days,\n        project_metrics.median_age_currently_open_assigned_days,\n\n        -- seconds\n        project_metrics.avg_close_time_seconds,\n        project_metrics.avg_assigned_close_time_seconds,\n\n        project_metrics.avg_age_currently_open_seconds,\n        project_metrics.avg_age_currently_open_assigned_seconds,\n\n        project_metrics.median_close_time_seconds, \n        project_metrics.median_age_currently_open_seconds,\n        project_metrics.median_assigned_close_time_seconds,\n        project_metrics.median_age_currently_open_assigned_seconds\n\n    from project\n    left join project_metrics on project.project_id = project_metrics.project_id\n    left join jira_user on project.project_lead_user_id = jira_user.user_id\n    left join agg_epics on project.project_id = agg_epics.project_id \n    \n    \n    left join agg_components on project.project_id = agg_components.project_id \n    \n\n)\n\nselect * from project_join", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira\".\"jira__project_enhanced\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.918348Z", "completed_at": "2024-03-21T15:31:53.933808Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.940147Z", "completed_at": "2024-03-21T15:31:53.940154Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.042038917541503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__project_metrics_project_id.1542338148", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_jira__project_metrics as (\nwith issue as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\"\n    where project_id is not null\n),\n\ncalculate_medians as (\n\n    select \n        project_id,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then open_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_close_time_seconds,\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then open_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_age_currently_open_seconds,\n\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then any_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_assigned_close_time_seconds,\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then any_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_age_currently_open_assigned_seconds\n\n    from issue\n\n     group by project_id \n),\n\n-- grouping because the medians were calculated using window functions (except in postgres)\nmedian_metrics as (\n\n    select \n        project_id, \n        median_close_time_seconds, \n        median_age_currently_open_seconds,\n        median_assigned_close_time_seconds,\n        median_age_currently_open_assigned_seconds\n\n    from calculate_medians\n    group by 1,2,3,4,5\n),\n\n\n-- get appropriate counts + sums to calculate averages\nproject_issues as (\n    select\n        project_id,\n        sum(case when resolved_at is not null then 1 else 0 end) as count_closed_issues,\n        sum(case when resolved_at is null then 1 else 0 end) as count_open_issues,\n\n        -- using the below to calculate averages\n\n        -- assigned issues\n        sum(case when resolved_at is null and assignee_user_id is not null then 1 else 0 end) as count_open_assigned_issues,\n        sum(case when resolved_at is not null and assignee_user_id is not null then 1 else 0 end) as count_closed_assigned_issues,\n\n        -- close time \n        sum(case when resolved_at is not null then open_duration_seconds else 0 end) as sum_close_time_seconds,\n        sum(case when resolved_at is not null then any_assignment_duration_seconds else 0 end) as sum_assigned_close_time_seconds,\n\n        -- age of currently open tasks\n        sum(case when resolved_at is null then open_duration_seconds else 0 end) as sum_currently_open_duration_seconds,\n        sum(case when resolved_at is null then any_assignment_duration_seconds else 0 end) as sum_currently_open_assigned_duration_seconds\n\n    from issue\n\n    group by 1\n),\n\ncalculate_avg_metrics as (\n\n    select\n        project_id,\n        count_closed_issues,\n        count_open_issues,\n        count_open_assigned_issues,\n\n        case when count_closed_issues = 0 then 0 else\n        round( cast(sum_close_time_seconds * 1.0 / count_closed_issues  as numeric(28,6) ), 0) end as avg_close_time_seconds,\n\n        case when count_closed_assigned_issues = 0 then 0 else\n        round( cast(sum_assigned_close_time_seconds * 1.0 / count_closed_assigned_issues  as numeric(28,6) ), 0) end as avg_assigned_close_time_seconds,\n\n        case when count_open_issues = 0 then 0 else\n        round( cast(sum_currently_open_duration_seconds * 1.0 / count_open_issues as numeric(28,6) ), 0) end as avg_age_currently_open_seconds,\n\n        case when count_open_assigned_issues = 0 then 0 else\n        round( cast(sum_currently_open_assigned_duration_seconds * 1.0 / count_open_assigned_issues as numeric(28,6) ), 0) end as avg_age_currently_open_assigned_seconds\n\n    from project_issues\n),\n\n-- join medians and averages + convert to days\njoin_metrics as (\n\n    select\n        calculate_avg_metrics.*,\n\n        -- there are 86400 seconds in a day\n        round( cast(calculate_avg_metrics.avg_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_close_time_days,\n        round( cast(calculate_avg_metrics.avg_assigned_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_assigned_close_time_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_assigned_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_assigned_days,\n\n        median_metrics.median_close_time_seconds, \n        median_metrics.median_age_currently_open_seconds,\n        median_metrics.median_assigned_close_time_seconds,\n        median_metrics.median_age_currently_open_assigned_seconds,\n\n        round( cast(median_metrics.median_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_days,\n        round( cast(median_metrics.median_assigned_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_assigned_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_assigned_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_assigned_days\n        \n    from calculate_avg_metrics\n    left join median_metrics using(project_id)\n)\n\nselect * from join_metrics\n) select project_id\nfrom __dbt__cte__int_jira__project_metrics\nwhere project_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.924377Z", "completed_at": "2024-03-21T15:31:53.939702Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.942796Z", "completed_at": "2024-03-21T15:31:53.942801Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021986961364746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__project_metrics_project_id.154ccc194e", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_jira__project_metrics as (\nwith issue as (\n\n    select * \n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\"\n    where project_id is not null\n),\n\ncalculate_medians as (\n\n    select \n        project_id,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then open_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_close_time_seconds,\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then open_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_age_currently_open_seconds,\n\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then any_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_assigned_close_time_seconds,\n        round( cast(\n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then any_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6) ), 0) as median_age_currently_open_assigned_seconds\n\n    from issue\n\n     group by project_id \n),\n\n-- grouping because the medians were calculated using window functions (except in postgres)\nmedian_metrics as (\n\n    select \n        project_id, \n        median_close_time_seconds, \n        median_age_currently_open_seconds,\n        median_assigned_close_time_seconds,\n        median_age_currently_open_assigned_seconds\n\n    from calculate_medians\n    group by 1,2,3,4,5\n),\n\n\n-- get appropriate counts + sums to calculate averages\nproject_issues as (\n    select\n        project_id,\n        sum(case when resolved_at is not null then 1 else 0 end) as count_closed_issues,\n        sum(case when resolved_at is null then 1 else 0 end) as count_open_issues,\n\n        -- using the below to calculate averages\n\n        -- assigned issues\n        sum(case when resolved_at is null and assignee_user_id is not null then 1 else 0 end) as count_open_assigned_issues,\n        sum(case when resolved_at is not null and assignee_user_id is not null then 1 else 0 end) as count_closed_assigned_issues,\n\n        -- close time \n        sum(case when resolved_at is not null then open_duration_seconds else 0 end) as sum_close_time_seconds,\n        sum(case when resolved_at is not null then any_assignment_duration_seconds else 0 end) as sum_assigned_close_time_seconds,\n\n        -- age of currently open tasks\n        sum(case when resolved_at is null then open_duration_seconds else 0 end) as sum_currently_open_duration_seconds,\n        sum(case when resolved_at is null then any_assignment_duration_seconds else 0 end) as sum_currently_open_assigned_duration_seconds\n\n    from issue\n\n    group by 1\n),\n\ncalculate_avg_metrics as (\n\n    select\n        project_id,\n        count_closed_issues,\n        count_open_issues,\n        count_open_assigned_issues,\n\n        case when count_closed_issues = 0 then 0 else\n        round( cast(sum_close_time_seconds * 1.0 / count_closed_issues  as numeric(28,6) ), 0) end as avg_close_time_seconds,\n\n        case when count_closed_assigned_issues = 0 then 0 else\n        round( cast(sum_assigned_close_time_seconds * 1.0 / count_closed_assigned_issues  as numeric(28,6) ), 0) end as avg_assigned_close_time_seconds,\n\n        case when count_open_issues = 0 then 0 else\n        round( cast(sum_currently_open_duration_seconds * 1.0 / count_open_issues as numeric(28,6) ), 0) end as avg_age_currently_open_seconds,\n\n        case when count_open_assigned_issues = 0 then 0 else\n        round( cast(sum_currently_open_assigned_duration_seconds * 1.0 / count_open_assigned_issues as numeric(28,6) ), 0) end as avg_age_currently_open_assigned_seconds\n\n    from project_issues\n),\n\n-- join medians and averages + convert to days\njoin_metrics as (\n\n    select\n        calculate_avg_metrics.*,\n\n        -- there are 86400 seconds in a day\n        round( cast(calculate_avg_metrics.avg_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_close_time_days,\n        round( cast(calculate_avg_metrics.avg_assigned_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_assigned_close_time_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_assigned_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_assigned_days,\n\n        median_metrics.median_close_time_seconds, \n        median_metrics.median_age_currently_open_seconds,\n        median_metrics.median_assigned_close_time_seconds,\n        median_metrics.median_age_currently_open_assigned_seconds,\n\n        round( cast(median_metrics.median_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_days,\n        round( cast(median_metrics.median_assigned_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_assigned_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_assigned_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_assigned_days\n        \n    from calculate_avg_metrics\n    left join median_metrics using(project_id)\n)\n\nselect * from join_metrics\n) select\n    project_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_jira__project_metrics\nwhere project_id is not null\ngroup by project_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.928606Z", "completed_at": "2024-03-21T15:31:53.940450Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.943380Z", "completed_at": "2024-03-21T15:31:53.943384Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02245616912841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.jira.jira__user_enhanced", "compiled": true, "compiled_code": "with  __dbt__cte__int_jira__user_metrics as (\nwith issue as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\" \n    where assignee_user_id is not null\n),\n\ncalculate_medians as (\n\n    select \n        assignee_user_id as user_id,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then last_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6)), 0) as median_close_time_seconds,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then last_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6)), 0) as median_age_currently_open_seconds\n\n    from issue\n\n     group by 1 \n),\n\n-- grouping because the medians were calculated using window functions (except postgres)\nmedian_metrics as (\n\n    select \n        user_id, \n        median_close_time_seconds, \n        median_age_currently_open_seconds\n\n    from calculate_medians\n    group by 1,2,3\n),\n\n\nuser_issues as (\n\n    select\n        assignee_user_id as user_id,\n        sum(case when resolved_at is not null then 1 else 0 end) as count_closed_issues,\n        sum(case when resolved_at is null then 1 else 0 end) as count_open_issues,\n\n        sum(case when resolved_at is not null then last_assignment_duration_seconds end) as sum_close_time_seconds,\n        sum(case when resolved_at is null then last_assignment_duration_seconds end) as sum_current_open_seconds\n\n    from issue\n\n    group by 1\n\n),\n\ncalculate_avg_metrics as (\n\n    select \n        user_id,\n        count_closed_issues,\n        count_open_issues,\n\n        case when count_closed_issues = 0 then 0 else\n        round( cast(sum_close_time_seconds * 1.0 / count_closed_issues as numeric(28,6) ), 0) end as avg_close_time_seconds,\n\n        case when count_open_issues = 0 then 0 else\n        round( cast(sum_current_open_seconds * 1.0 / count_open_issues as numeric(28,6) ), 0) end as avg_age_currently_open_seconds\n\n    from user_issues\n),\n\njoin_metrics as (\n\n    select\n        calculate_avg_metrics.*,\n        round( cast(calculate_avg_metrics.avg_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_close_time_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_days,\n\n        median_metrics.median_close_time_seconds,\n        median_metrics.median_age_currently_open_seconds,\n\n        round( cast(median_metrics.median_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_days\n        \n    from calculate_avg_metrics\n    left join median_metrics using(user_id)\n)\n\nselect * from join_metrics\n), jira_user as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira_source\".\"stg_jira__user\"\n),\n\nuser_metrics as (\n\n    select *\n    from __dbt__cte__int_jira__user_metrics\n),\n\nissue as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\" \n),\n\nuser_project as (\n\n    select \n        assignee_user_id,\n        project_name\n\n    from issue\n    group by 1,2\n\n),\n\nagg_user_projects as (\n\n    select \n        assignee_user_id,\n        \n    string_agg(project_name, ', ')\n\n as projects\n\n    from user_project\n    group by 1\n),\n\nuser_join as (\n\n    select\n        jira_user.*,\n        agg_user_projects.projects, -- projects they've worked on issues for\n        coalesce(user_metrics.count_closed_issues, 0) as count_closed_issues,\n        coalesce(user_metrics.count_open_issues, 0) as count_open_issues,\n\n        -- days\n        user_metrics.avg_close_time_days,\n        user_metrics.avg_age_currently_open_days,\n        \n        user_metrics.median_close_time_days,\n        user_metrics.median_age_currently_open_days,\n\n        -- seconds\n        user_metrics.avg_close_time_seconds,\n        user_metrics.avg_age_currently_open_seconds,\n        \n        user_metrics.median_close_time_seconds,\n        user_metrics.median_age_currently_open_seconds\n\n    from jira_user \n    left join user_metrics on jira_user.user_id = user_metrics.user_id\n    left join agg_user_projects on jira_user.user_id = agg_user_projects.assignee_user_id\n)\n\nselect * from user_join", "relation_name": "\"postgres\".\"jira_integrations_tests_33_jira\".\"jira__user_enhanced\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.945662Z", "completed_at": "2024-03-21T15:31:53.956706Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.962169Z", "completed_at": "2024-03-21T15:31:53.962177Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02403998374938965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_int_jira__user_metrics_user_id.2143177b14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_jira__user_metrics as (\nwith issue as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\" \n    where assignee_user_id is not null\n),\n\ncalculate_medians as (\n\n    select \n        assignee_user_id as user_id,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then last_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6)), 0) as median_close_time_seconds,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then last_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6)), 0) as median_age_currently_open_seconds\n\n    from issue\n\n     group by 1 \n),\n\n-- grouping because the medians were calculated using window functions (except postgres)\nmedian_metrics as (\n\n    select \n        user_id, \n        median_close_time_seconds, \n        median_age_currently_open_seconds\n\n    from calculate_medians\n    group by 1,2,3\n),\n\n\nuser_issues as (\n\n    select\n        assignee_user_id as user_id,\n        sum(case when resolved_at is not null then 1 else 0 end) as count_closed_issues,\n        sum(case when resolved_at is null then 1 else 0 end) as count_open_issues,\n\n        sum(case when resolved_at is not null then last_assignment_duration_seconds end) as sum_close_time_seconds,\n        sum(case when resolved_at is null then last_assignment_duration_seconds end) as sum_current_open_seconds\n\n    from issue\n\n    group by 1\n\n),\n\ncalculate_avg_metrics as (\n\n    select \n        user_id,\n        count_closed_issues,\n        count_open_issues,\n\n        case when count_closed_issues = 0 then 0 else\n        round( cast(sum_close_time_seconds * 1.0 / count_closed_issues as numeric(28,6) ), 0) end as avg_close_time_seconds,\n\n        case when count_open_issues = 0 then 0 else\n        round( cast(sum_current_open_seconds * 1.0 / count_open_issues as numeric(28,6) ), 0) end as avg_age_currently_open_seconds\n\n    from user_issues\n),\n\njoin_metrics as (\n\n    select\n        calculate_avg_metrics.*,\n        round( cast(calculate_avg_metrics.avg_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_close_time_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_days,\n\n        median_metrics.median_close_time_seconds,\n        median_metrics.median_age_currently_open_seconds,\n\n        round( cast(median_metrics.median_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_days\n        \n    from calculate_avg_metrics\n    left join median_metrics using(user_id)\n)\n\nselect * from join_metrics\n) select user_id\nfrom __dbt__cte__int_jira__user_metrics\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.950891Z", "completed_at": "2024-03-21T15:31:53.961724Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.966859Z", "completed_at": "2024-03-21T15:31:53.966865Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023507118225097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_int_jira__user_metrics_user_id.c042bcdd66", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_jira__user_metrics as (\nwith issue as (\n\n    select *\n    from \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__issue_enhanced\" \n    where assignee_user_id is not null\n),\n\ncalculate_medians as (\n\n    select \n        assignee_user_id as user_id,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is not null then last_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6)), 0) as median_close_time_seconds,\n        round( cast( \n\n    percentile_cont( \n        0.5 )\n        within group ( order by case when resolved_at is null then last_assignment_duration_seconds end )\n    /* have to group by partition field */\n\n as numeric(28,6)), 0) as median_age_currently_open_seconds\n\n    from issue\n\n     group by 1 \n),\n\n-- grouping because the medians were calculated using window functions (except postgres)\nmedian_metrics as (\n\n    select \n        user_id, \n        median_close_time_seconds, \n        median_age_currently_open_seconds\n\n    from calculate_medians\n    group by 1,2,3\n),\n\n\nuser_issues as (\n\n    select\n        assignee_user_id as user_id,\n        sum(case when resolved_at is not null then 1 else 0 end) as count_closed_issues,\n        sum(case when resolved_at is null then 1 else 0 end) as count_open_issues,\n\n        sum(case when resolved_at is not null then last_assignment_duration_seconds end) as sum_close_time_seconds,\n        sum(case when resolved_at is null then last_assignment_duration_seconds end) as sum_current_open_seconds\n\n    from issue\n\n    group by 1\n\n),\n\ncalculate_avg_metrics as (\n\n    select \n        user_id,\n        count_closed_issues,\n        count_open_issues,\n\n        case when count_closed_issues = 0 then 0 else\n        round( cast(sum_close_time_seconds * 1.0 / count_closed_issues as numeric(28,6) ), 0) end as avg_close_time_seconds,\n\n        case when count_open_issues = 0 then 0 else\n        round( cast(sum_current_open_seconds * 1.0 / count_open_issues as numeric(28,6) ), 0) end as avg_age_currently_open_seconds\n\n    from user_issues\n),\n\njoin_metrics as (\n\n    select\n        calculate_avg_metrics.*,\n        round( cast(calculate_avg_metrics.avg_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as avg_close_time_days,\n        round( cast(calculate_avg_metrics.avg_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as avg_age_currently_open_days,\n\n        median_metrics.median_close_time_seconds,\n        median_metrics.median_age_currently_open_seconds,\n\n        round( cast(median_metrics.median_close_time_seconds / 86400.0 as numeric(28,6) ), 0) as median_close_time_days,\n        round( cast(median_metrics.median_age_currently_open_seconds / 86400.0 as numeric(28,6) ), 0) as median_age_currently_open_days\n        \n    from calculate_avg_metrics\n    left join median_metrics using(user_id)\n)\n\nselect * from join_metrics\n) select\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_jira__user_metrics\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.958410Z", "completed_at": "2024-03-21T15:31:53.967137Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.970018Z", "completed_at": "2024-03-21T15:31:53.970022Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02123117446899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_jira__project_enhanced_project_id.4f7c58f1d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect project_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__project_enhanced\"\nwhere project_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.962487Z", "completed_at": "2024-03-21T15:31:53.967747Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.970692Z", "completed_at": "2024-03-21T15:31:53.970698Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018379688262939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_jira__project_enhanced_project_id.c18e39faef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    project_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__project_enhanced\"\nwhere project_id is not null\ngroup by project_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.972007Z", "completed_at": "2024-03-21T15:31:53.979437Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.980389Z", "completed_at": "2024-03-21T15:31:53.980395Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012336015701293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.not_null_jira__user_enhanced_user_id.aecc00744a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__user_enhanced\"\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-21T15:31:53.976410Z", "completed_at": "2024-03-21T15:31:53.980111Z"}, {"name": "execute", "started_at": "2024-03-21T15:31:53.981591Z", "completed_at": "2024-03-21T15:31:53.981601Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011308670043945312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.jira.unique_jira__user_enhanced_user_id.c9ee73454a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"jira_integrations_tests_33_jira\".\"jira__user_enhanced\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 4.60219407081604, "args": {"use_colors": true, "indirect_selection": "eager", "exclude": [], "log_format_file": "debug", "populate_cache": true, "log_path": "/Users/joseph.markiewicz/Documents/dbt_packages/jira/dbt_jira/integration_tests/logs", "log_level_file": "debug", "partial_parse_file_diff": true, "print": true, "vars": {}, "cache_selected_only": false, "quiet": false, "defer": false, "invocation_command": "dbt docs generate -t postgres", "partial_parse": true, "enable_legacy_logger": false, "write_json": true, "log_format": "default", "select": [], "favor_state": false, "version_check": true, "profiles_dir": "/Users/joseph.markiewicz/.dbt", "warn_error_options": {"include": [], "exclude": []}, "compile": true, "project_dir": "/Users/joseph.markiewicz/Documents/dbt_packages/jira/dbt_jira/integration_tests", "static_parser": true, "target": "postgres", "which": "generate", "show_resource_report": false, "strict_mode": false, "log_level": "info", "use_colors_file": true, "empty_catalog": false, "introspect": true, "log_file_max_bytes": 10485760, "printer_width": 80, "macro_debugging": false, "static": false, "send_anonymous_usage_stats": true}}